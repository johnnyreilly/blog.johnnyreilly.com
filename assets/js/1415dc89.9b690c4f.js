"use strict";(self.webpackChunkjohnnyreilly_com=self.webpackChunkjohnnyreilly_com||[]).push([[70800],{86913:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>a,toc:()=>p});var i=n(74848),s=n(28453);const r={slug:"typescript-and-requirejs-keep-it-simple",title:"TypeScript and RequireJS (Keep It Simple)",authors:"johnnyreilly",tags:["typescript"],hide_table_of_contents:!1,description:"This article explains how to mix TypeScript and RequireJS, gives examples of the code changes needed, and shows how to create a demo."},o=void 0,a={permalink:"/typescript-and-requirejs-keep-it-simple",editUrl:"https://github.com/johnnyreilly/blog.johnnyreilly.com/edit/main/blog-website/blog/2014-02-27-typescript-and-requirejs-keep-it-simple/index.md",source:"@site/blog/2014-02-27-typescript-and-requirejs-keep-it-simple/index.md",title:"TypeScript and RequireJS (Keep It Simple)",description:"This article explains how to mix TypeScript and RequireJS, gives examples of the code changes needed, and shows how to create a demo.",date:"2014-02-27T00:00:00.000Z",tags:[{inline:!1,label:"TypeScript",permalink:"/tags/typescript",description:"The TypeScript programming language."}],readingTime:4.06,hasTruncateMarker:!0,authors:[{name:"John Reilly",title:"OSS Engineer - TypeScript, Azure, React, Node.js, .NET",url:"https://johnnyreilly.com/about",imageURL:"https://johnnyreilly.com/img/profile.jpg",key:"johnnyreilly"}],frontMatter:{slug:"typescript-and-requirejs-keep-it-simple",title:"TypeScript and RequireJS (Keep It Simple)",authors:"johnnyreilly",tags:["typescript"],hide_table_of_contents:!1,description:"This article explains how to mix TypeScript and RequireJS, gives examples of the code changes needed, and shows how to create a demo."},unlisted:!1,prevItem:{title:"Caching and cache-busting with RequireJS",permalink:"/caching-and-cache-busting-with-requirejs"},nextItem:{title:"WPF and Mystic Meg or Playing Futurologist",permalink:"/wpf-and-mystic-meg-or-playing"}},l={authorsImageUrls:[void 0]},p=[{value:"Closing Thoughts",id:"closing-thoughts",level:2},{value:"Finally for bonus points....",id:"finally-for-bonus-points",level:2},{value:"Want the code for your very own?",id:"want-the-code-for-your-very-own",level:2}];function c(e){const t={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.p,{children:["I'm not the first to take a look at mixing TypeScript and RequireJS but I wanted to get it clear in my head. Also, I've always felt the best way to learn is to do. So here we go. I'm going to create a TypeScript and RequireJS demo based on ",(0,i.jsx)(t.a,{href:"https://github.com/johnpapa/kis-requirejs-demo/",children:'John Papa\'s "Keep It Simple RequireJS Demo"'}),"."]}),"\n",(0,i.jsx)(t.p,{children:"So let's fire up Visual Studio 2013 and create a new ASP.NET Web Application called \u201cRequireJSandTypeScript\u201d (the empty project template is fine)."}),"\n",(0,i.jsxs)(t.p,{children:["Add a new HTML file to the root called \u201cindex.html\u201d and base it on \u201cindex3.html\u201d from ",(0,i.jsx)(t.a,{href:"https://github.com/johnpapa/kis-requirejs-demo/blob/master/ModularDemo/index3.html",children:"John Papa\u2019s demo"}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-html",children:'<!doctype html>\n<html>\n  <head>\n    <title>TypeScript with RequireJS</title>\n  </head>\n  <body>\n    <div>\n      <h1>TypeScript with RequireJS loading jQuery in Visual Studio land</h1>\n    </div>\n\n    \x3c!-- use jquery to load this message--\x3e\n    <p id="message"></p>\n\n    \x3c!-- Shortcut to load require and then load main--\x3e\n    <script\n      src="/scripts/require.js"\n      data-main="/scripts/main"\n      type="text/javascript"\n    ><\/script>\n  </body>\n</html>\n'})}),"\n",(0,i.jsx)(t.p,{children:"John\u2019s demo depends on jQuery and RequireJS (not too surprisingly) so let\u2019s fire up Nuget and get them:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ps",children:"Install-Package RequireJS\nInstall-Package jQuery\n"})}),"\n",(0,i.jsx)(t.p,{children:"Whilst we\u2019re at it, let\u2019s get the Definitely Typed typings as well:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ps",children:"Install-Package jQuery.TypeScript.DefinitelyTyped\n"})}),"\n",(0,i.jsx)(t.p,{children:"To my surprise this popped up a dialog."}),"\n",(0,i.jsx)(t.p,{children:'By "Your project has been configured to support TypeScript." it means that the csproj file has had the following entries added:'}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-xml",children:'<Project ToolsVersion="12.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">\n  <Import Project="$(MSBuildExtensionsPath32)\\Microsoft\\VisualStudio\\v$(VisualStudioVersion)\\TypeScript\\Microsoft.TypeScript.Default.props" Condition="Exists(\'$(MSBuildExtensionsPath32)\\Microsoft\\VisualStudio\\v$(VisualStudioVersion)\\TypeScript\\Microsoft.TypeScript.Default.props\')" />\n  ...\n  <PropertyGroup>\n    ...\n    <TypeScriptToolsVersion>0.9</TypeScriptToolsVersion>\n  </PropertyGroup>\n  ...\n  <Import Project="$(MSBuildExtensionsPath32)\\Microsoft\\VisualStudio\\v$(VisualStudioVersion)\\TypeScript\\Microsoft.TypeScript.targets" Condition="Exists(\'$(MSBuildExtensionsPath32)\\Microsoft\\VisualStudio\\v$(VisualStudioVersion)\\TypeScript\\Microsoft.TypeScript.targets\')" />\n  ...\n</Project>\n'})}),"\n",(0,i.jsxs)(t.p,{children:["I\u2019m not sure when this tweak to the Visual Studio tooling was added was added. Perhaps it's part of the ",(0,i.jsx)(t.a,{href:"https://blogs.msdn.com/b/typescript/archive/2014/02/25/announcing-typescript-1-0rc.aspx",children:"TypeScript 1.0 RC release"}),"; either way it\u2019s pretty nice. Let's press on."]}),"\n",(0,i.jsx)(t.p,{children:"Whilst we\u2019re at it let\u2019s make sure that we\u2019re compiling to AMD (to be RequireJS friendly) by adding in the following csproj tweaks just before the Microsoft.TypeScript.targets Project import statement:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-xml",children:"<PropertyGroup Condition=\"'$(Configuration)' == 'Debug'\">\n    <TypeScriptModuleKind>amd</TypeScriptModuleKind>\n  </PropertyGroup>\n  <PropertyGroup Condition=\"'$(Configuration)' == 'Release'\">\n    <TypeScriptModuleKind>amd</TypeScriptModuleKind>\n  </PropertyGroup>\n"})}),"\n",(0,i.jsx)(t.p,{children:"Where was I? Oh yes, typings. So let\u2019s get the RequireJS typings too:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ps",children:"Install-Package requirejs.TypeScript.DefinitelyTyped\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Right \u2013 looking at index.html we can see from the data-main tag that the first file loaded by RequireJS, our bootstrapper if you will, is main.js. So let\u2019s add ourselves a main.ts based on ",(0,i.jsx)(t.a,{href:"https://github.com/johnpapa/kis-requirejs-demo/blob/master/ModularDemo/Scripts3/main.js",children:"John's example"})," (which will in turn generate a main.js):"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:"(function () {\n  requirejs.config({\n    baseUrl: 'scripts',\n    paths: {\n      jquery: 'jquery-2.1.0',\n    },\n  });\n\n  require(['alerter'], (alerter) => {\n    alerter.showMessage();\n  });\n})();\n"})}),"\n",(0,i.jsxs)(t.p,{children:["main.ts depends upon ",(0,i.jsx)(t.a,{href:"https://github.com/johnpapa/kis-requirejs-demo/blob/master/ModularDemo/Scripts3/alerter.js",children:"alerter"})," so let\u2019s add ourselves an alerter.ts as well:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:"define('alerter', ['jquery', 'dataservice'], function ($, dataservice) {\n  var name = 'John',\n    showMessage = function () {\n      var msg = dataservice.getMessage();\n\n      $('#message').text(msg + ', ' + name);\n    };\n\n  return {\n    showMessage: showMessage,\n  };\n});\n"})}),"\n",(0,i.jsxs)(t.p,{children:["And a ",(0,i.jsx)(t.a,{href:"https://github.com/johnpapa/kis-requirejs-demo/blob/master/ModularDemo/Scripts3/dataservice.js",children:"dataservice.ts"}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:"define('dataservice', [], function () {\n  var msg = 'Welcome to Code Camp',\n    getMessage = function () {\n      return msg;\n    };\n\n  return {\n    getMessage: getMessage,\n  };\n});\n"})}),"\n",(0,i.jsx)(t.p,{children:"That all compiles fine. But we\u2019re missing a trick. We\u2019re supposed to be using TypeScripts AMD support so let\u2019s change the code to do just that. First dataservice.ts:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:"var msg = 'Welcome to Code Camp';\n\nexport function getMessage() {\n  return msg;\n}\n"})}),"\n",(0,i.jsx)(t.p,{children:"Then alerter.ts:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:"import $ = require('jquery');\nimport dataservice = require('dataservice');\n\nvar name = 'John';\n\nexport function showMessage() {\n  var msg = dataservice.getMessage();\n\n  $('#message').text(msg + ', ' + name);\n}\n"})}),"\n",(0,i.jsx)(t.p,{children:"I know both of the above look slightly different but if you look close you'll see it's really only boilerplate changes. The actual application code is unaffected. Finally, main.ts remains as it is and that's us done; we have ourselves a working demo... Yay!"}),"\n",(0,i.jsx)(t.p,{children:"Thanks to John Papa for creating such a simple demo I could use as the basis for my own demo."}),"\n",(0,i.jsx)(t.h2,{id:"closing-thoughts",children:"Closing Thoughts"}),"\n",(0,i.jsx)(t.p,{children:"Unfortunately there is no typing on the alerter reference within main.ts. To my knowledge there is no way to implicitly import the typings here \u2013 the only thing you can do is specify them manually. (By the way, if I'm wrong about this then please do set me straight!) That said, this is not so bad really since this main.ts file is essentially just a bootstrapper that kicks things off. All the other files contain the real application code and they have have typings a-go-go. So we're happy."}),"\n",(0,i.jsx)(t.h2,{id:"finally-for-bonus-points",children:"Finally for bonus points...."}),"\n",(0,i.jsx)(t.p,{children:"I\u2019ve included the js and js.map files in the project file as they don't seem to be added into the project by Visual Studio when the TS file is created or when it is compiled for the first time. I've also ensured that these files are dependent upon the typescript files they were generated from."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-xml",children:'<TypeScriptCompile Include="Scripts\\alerter.ts" />\n    <Content Include="Scripts\\alerter.js">\n        <DependentUpon>alerter.ts</DependentUpon>\n    </Content>\n    <Content Include="Scripts\\alerter.js.map">\n        <DependentUpon>alerter.ts</DependentUpon>\n    </Content>\n    <TypeScriptCompile Include="Scripts\\dataservice.ts" />\n    <Content Include="Scripts\\dataservice.js">\n        <DependentUpon>dataservice.ts</DependentUpon>\n    </Content>\n    <Content Include="Scripts\\dataservice.js.map">\n        <DependentUpon>dataservice.ts</DependentUpon>\n    </Content>\n    <TypeScriptCompile Include="Scripts\\main.ts" />\n    <Content Include="Scripts\\main.js">\n        <DependentUpon>main.ts</DependentUpon>\n    </Content>\n    <Content Include="Scripts\\main.js.map">\n        <DependentUpon>main.ts</DependentUpon>\n    </Content>\n'})}),"\n",(0,i.jsx)(t.h2,{id:"want-the-code-for-your-very-own",children:"Want the code for your very own?"}),"\n",(0,i.jsxs)(t.p,{children:["Well you can grab it from ",(0,i.jsx)(t.a,{href:"https://github.com/johnnyreilly/RequireJSandTypeScript",children:"GitHub"}),"."]})]})}function d(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var i=n(96540);const s={},r=i.createContext(s);function o(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);