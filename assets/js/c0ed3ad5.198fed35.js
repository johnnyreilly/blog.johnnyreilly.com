"use strict";(self.webpackChunkjohnnyreilly_com=self.webpackChunkjohnnyreilly_com||[]).push([[78358],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var o=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},l=Object.keys(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=o.createContext({}),d=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=d(e.components);return o.createElement(s.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=d(n),m=a,h=p["".concat(s,".").concat(m)]||p[m]||u[m]||l;return n?o.createElement(h,r(r({ref:t},c),{},{components:n})):o.createElement(h,r({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,r=new Array(l);r[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[p]="string"==typeof e?e:a,r[1]=i;for(var d=2;d<l;d++)r[d]=n[d];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},68428:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>d,toc:()=>p});n(67294);var o=n(3905);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function r(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},l=Object.keys(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const i={slug:"upgrading-to-globalize-1x-for-dummies",title:"Upgrading to Globalize 1.x for Dummies",authors:"johnnyreilly",tags:["globalize"],hide_table_of_contents:!1,description:"Migrating to Globalize 1.0, which modularized the code, requires a significant amount of work, as shown by John Reilly\u2019s examples."},s=void 0,d={permalink:"/upgrading-to-globalize-1x-for-dummies",editUrl:"https://github.com/johnnyreilly/blog.johnnyreilly.com/edit/main/blog-website/blog/2015-07-30-upgrading-to-globalize-1x-for-dummies/index.md",source:"@site/blog/2015-07-30-upgrading-to-globalize-1x-for-dummies/index.md",title:"Upgrading to Globalize 1.x for Dummies",description:"Migrating to Globalize 1.0, which modularized the code, requires a significant amount of work, as shown by John Reilly\u2019s examples.",date:"2015-07-30T00:00:00.000Z",formattedDate:"July 30, 2015",tags:[{label:"globalize",permalink:"/tags/globalize"}],readingTime:9.415,hasTruncateMarker:!0,authors:[{name:"John Reilly",title:"OSS Engineer - TypeScript, Azure, React, Node.js, .NET",url:"https://johnnyreilly.com/about",imageURL:"https://johnnyreilly.com/img/profile.jpg",key:"johnnyreilly"}],frontMatter:{slug:"upgrading-to-globalize-1x-for-dummies",title:"Upgrading to Globalize 1.x for Dummies",authors:"johnnyreilly",tags:["globalize"],hide_table_of_contents:!1,description:"Migrating to Globalize 1.0, which modularized the code, requires a significant amount of work, as shown by John Reilly\u2019s examples."},prevItem:{title:"(Top One, Nice One) Get Sorted",permalink:"/top-one-nice-one-get-sorted"},nextItem:{title:"npm please stop hurting Visual Studio",permalink:"/npm-please-stop-hurting-visual-studio"}},c={authorsImageUrls:[void 0]},p=[{value:"Updated our Bower dependencies",id:"updated-our-bower-dependencies",level:2},{value:"We need fuel",id:"we-need-fuel",level:2},{value:"Some bitching and moaning.",id:"some-bitching-and-moaning",level:2},{value:"Take the modules and run",id:"take-the-modules-and-run",level:2},{value:"Updated 30/08/2015: Globalize \xb7 So What&#39;cha Want",id:"updated-30082015-globalize--so-whatcha-want",level:3},{value:"The Actual Migration",id:"the-actual-migration",level:2},{value:"Observations",id:"observations",level:2}],u={toc:p},m="wrapper";function h(e){var{components:t}=e,i=r(e,["components"]);return(0,o.kt)(m,l(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){a(e,t,n[t])}))}return e}({},u,i),{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Globalize has hit 1.0. Anyone who reads my blog will likely be aware that I'm a long time user of ",(0,o.kt)("a",{parentName:"p",href:"/globalizejs-number-and-date"},"Globalize 0.1.x"),". I've been a little daunted by the leap that the move from 0.1.x to 1.x represents. It appears to be the very definition of \"breaking changes\". :-) But hey, this is Semantic Versioning being used correctly so how could I complain? Either way, I've decided to write up the migration here as I'm not expecting this to be easy."),(0,o.kt)("p",null,"To kick things off I've set up a very ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/johnnyreilly/globalize-migration/tree/v0.1.x"},"simple repo")," that consists of a single page that depends upon Globalize 0.1.x to render a number and a date in German. It looks like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<html>\n  <head>\n    <title>Globalize demo</title>\n    <link\n      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"\n      rel="stylesheet"\n    />\n  </head>\n  <body>\n    <div class="container-fluid">\n      <h4>Globalize demo for the <em id="locale"></em> culture / locale</h4>\n      <p>\n        This is a the number <strong id="number"></strong> formatted by\n        Globalize: <strong id="numberFormatted"></strong>\n      </p>\n      <p>\n        This is a the number <strong id="date"></strong> formatted by Globalize:\n        <strong id="dateFormatted"></strong>\n      </p>\n    </div>\n\n    <script src="bower_components/globalize/lib/globalize.js"><\/script>\n    <script src="bower_components/globalize/lib/cultures/globalize.culture.de-DE.js"><\/script>\n    <script>\n      var locale = \'de-DE\';\n      var number = 12345.67;\n      var date = new Date(2012, 5, 15);\n\n      Globalize.culture(locale);\n      document.querySelector(\'#locale\').innerText = locale;\n      document.querySelector(\'#number\').innerText = number;\n      document.querySelector(\'#date\').innerText = date;\n      document.querySelector(\'#numberFormatted\').innerText = Globalize.format(\n        number,\n        \'n2\',\n      );\n      document.querySelector(\'#dateFormatted\').innerText = Globalize.format(\n        date,\n        \'d\',\n      );\n    <\/script>\n  </body>\n</html>\n')),(0,o.kt)("p",null,"When it's run it looks like this:"),(0,o.kt)("p",null,(0,o.kt)("img",{loading:"eager",fetchpriority:"high",src:n(26740).Z,width:"640",height:"162"})),(0,o.kt)("p",null,"Let's see how we go about migrating this super simple example."),(0,o.kt)("h2",{id:"updated-our-bower-dependencies"},"Updated our Bower dependencies"),(0,o.kt)("p",null,"First things first, we want to move Globalize from 0.1.x to 1.x using Bower. To do that we update our ",(0,o.kt)("inlineCode",{parentName:"p"},"bower.json"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'"dependencies": {\n    "globalize": "^1.0.0"\n  }\n')),(0,o.kt)("p",null,"Now we enter: ",(0,o.kt)("inlineCode",{parentName:"p"},"bower update"),". And we're off!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"bower globalize#^1.0.0          cached git://github.com/jquery/globalize.git#1.0.0\nbower globalize#^1.0.0        validate 1.0.0 against git://github.com/jquery/globalize.git#^1.0.0\nbower cldr-data#>=25            cached git://github.com/rxaviers/cldr-data-bower.git#27.0.3\nbower cldr-data#>=25          validate 27.0.3 against git://github.com/rxaviers/cldr-data-bower.git#>=25\nbower cldrjs#0.4.1              cached git://github.com/rxaviers/cldrjs.git#0.4.1\nbower cldrjs#0.4.1            validate 0.4.1 against git://github.com/rxaviers/cldrjs.git#0.4.1\nbower globalize#^1.0.0         install globalize#1.0.0\nbower cldr-data#>=25           install cldr-data#27.0.3\nbower cldrjs#0.4.1             install cldrjs#0.4.1\n\nglobalize#1.0.0 bower_components\\globalize\n\u251c\u2500\u2500 cldr-data#27.0.3\n\u2514\u2500\u2500 cldrjs#0.4.1\n\ncldr-data#27.0.3 bower_components\\cldr-data\n\ncldrjs#0.4.1 bower_components\\cldrjs\n\u2514\u2500\u2500 cldr-data#27.0.3\n")),(0,o.kt)("p",null,"This all looks happy enough. Except it's actually not."),(0,o.kt)("h2",{id:"we-need-fuel"},"We need fuel"),(0,o.kt)("p",null,'Or as I like to call it cldr-data. We just pulled down Globalize 1.x but we didn\'t pull down the data that Globalize 1.x relies upon. This is one of the differences between Globalize 0.1.x and 1.x. Globalize 1.x does not include the "culture" data. By which I mean all the ',(0,o.kt)("inlineCode",{parentName:"p"},"globalize.culture.de-DE.js")," type files. Instead Globalize 1.x relies upon ",(0,o.kt)("a",{parentName:"p",href:"http://cldr.unicode.org/"},"CLDR - Unicode Common Locale Data Repository"),". It does this in the form of ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/unicode-cldr/cldr-json"},"cldr-json"),"."),(0,o.kt)("p",null,"Now before you start to worry, you shouldn't actually need to go and get this by yourself, the lovely ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/rxaviers"},"Rafael Xavier de Souza")," has saved you a job by putting together ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/rxaviers/cldr-data-bower"},"Bower")," and ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/rxaviers/cldr-data-npm"},"npm")," modules to do the hard work for you."),(0,o.kt)("p",null,"I'm using Bower for my client side package management and so I'll use that. Looking at the Bower dependencies downloaded when I upgraded my package I can see there is a ",(0,o.kt)("inlineCode",{parentName:"p"},"cldr-data")," package. Yay! However it appears to be missing the associated json files. Boo!"),(0,o.kt)("p",null,"To the documentation Batman. It says you need a ",(0,o.kt)("inlineCode",{parentName:"p"},".bowerrc")," file in your repo which contains this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'{\n  "scripts": {\n    "preinstall": "npm install cldr-data-downloader@0.2.x",\n    "postinstall": "node ./node_modules/cldr-data-downloader/bin/download.js -i bower_components/cldr-data/index.json -o bower_components/cldr-data/"\n  }\n}\n')),(0,o.kt)("p",null,"Unfortunately, because I've already upgraded to v1 adding this file alone doesn't do anything for me. To get round that I delete my ",(0,o.kt)("inlineCode",{parentName:"p"},"bower_components")," folder and enter ",(0,o.kt)("inlineCode",{parentName:"p"},"bower install"),". Boom!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"bower globalize#^1.0.0          cached git://github.com/jquery/globalize.git#1.0.0\nbower globalize#^1.0.0        validate 1.0.0 against git://github.com/jquery/globalize.git#^1.0.0\nbower cldrjs#0.4.1                        cached git://github.com/rxaviers/cldrjs.git#0.4.1\nbower cldrjs#0.4.1                      validate 0.4.1 against git://github.com/rxaviers/cldrjs.git#0.4.1\nbower cldr-data#>=25                      cached git://github.com/rxaviers/cldr-data-bower.git#27.0.3\nbower cldr-data#>=25                    validate 27.0.3 against git://github.com/rxaviers/cldr-data-bower.git#>=25\nbower                                 preinstall npm install cldr-data-downloader@0.2.x\nbower                                 preinstall cldr-data-downloader@0.2.3 node_modules\\cldr-data-downloader\nbower                                 preinstall \u251c\u2500\u2500 progress@1.1.8\nbower                                 preinstall \u251c\u2500\u2500 q@1.0.1\nbower                                 preinstall \u251c\u2500\u2500 request-progress@0.3.1 (throttleit@0.0.2)\nbower                                 preinstall \u251c\u2500\u2500 nopt@3.0.3 (abbrev@1.0.7)\nbower                                 preinstall \u251c\u2500\u2500 mkdirp@0.5.0 (minimist@0.0.8)\nbower                                 preinstall \u251c\u2500\u2500 adm-zip@0.4.4\nbower                                 preinstall \u251c\u2500\u2500 npmconf@2.0.9 (uid-number@0.0.5, ini@1.3.4, inherits@2.0.1, once@1.3.2, osenv@0.1.3, config-chain@1.1.9, semver@4.3.6)\nbower                                 preinstall \u2514\u2500\u2500 request@2.53.0 (caseless@0.9.0, forever-agent@0.5.2, aws-sign2@0.5.0, stringstream@0.0.4, tunnel-agent@0.4.1, oauth-sign@0.6.0, isstream@0.1.2, json-stringify-safe@5.0.1, qs@2.3.3, node-uuid@1.4.3, combined-stream@0.0.7, mime-types@2.0.14, form-data@0.2.0, tough-cookie@2.0.0, bl@0.9.4, http-signature@0.10.1, hawk@2.3.1)\nbower globalize#^1.0.0                   install globalize#1.0.0\nbower cldrjs#0.4.1                       install cldrjs#0.4.1\nbower cldr-data#>=25                     install cldr-data#27.0.3\nbower                                postinstall node ./node_modules/cldr-data-downloader/bin/download.js -i bower_components/cldr-data/index.json -o bower_components/cldr-data/\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-core/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-dates-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-cal-buddhist-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-cal-chinese-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-cal-coptic-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-cal-dangi-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-cal-ethiopic-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-cal-hebrew-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-cal-indian-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-cal-islamic-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-cal-japanese-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-cal-persian-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-cal-roc-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-localenames-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-misc-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-numbers-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-segments-modern/archive/27.0.3.zip`\nbower                                postinstall GET `https://github.com/unicode-cldr/cldr-units-modern/archive/27.0.3.zip`\nbower                                postinstall Received 28728K total.\nbower                                postinstall Received 28753K total.\nbower                                postinstall Unpacking it into `./bower_components\\cldr-data`\n\nglobalize#1.0.0 bower_components\\globalize\n\u251c\u2500\u2500 cldr-data#27.0.3\n\u2514\u2500\u2500 cldrjs#0.4.1\n\ncldrjs#0.4.1 bower_components\\cldrjs\n\u2514\u2500\u2500 cldr-data#27.0.3\n\ncldr-data#27.0.3 bower_components\\cldr-data\n")),(0,o.kt)("p",null,"That's right - I'm golden. And if I didn't want to do that I could have gone straight to the command line and entered this: (look familiar?)"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"npm install cldr-data-downloader@0.2.x\nnode ./node_modules/cldr-data-downloader/bin/download.js -i bower_components/cldr-data/index.json -o bower_components/cldr-data/\n")),(0,o.kt)("h2",{id:"some-bitching-and-moaning"},"Some bitching and moaning."),(0,o.kt)("p",null,"If, like me, you were a regular user of Globalize 0.1.x then you know that you needed very little to get going. As you can see from our example you just serve up ",(0,o.kt)("inlineCode",{parentName:"p"},"Globalize.js")," and the culture files you are interested in (eg ",(0,o.kt)("inlineCode",{parentName:"p"},"globalize.culture.de-DE.js"),"). That's it - you have all you need; job's a good'un. This is all very convenient and entirely lovely."),(0,o.kt)("p",null,"Globalize 1.x has a different approach and one that (I have to be honest) I'm not entirely on board with. The thing that you need to know about the new Globalize is that ",(0,o.kt)("em",{parentName:"p"},"nothing comes for free"),". It's been completely modularised and ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/jquery/globalize#pick-the-modules-you-need"},"you have to include extra libraries depending on the functionality you require.")," On top of that you then have to work out the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/jquery/globalize#2-cldr-content"},"portions of the cldr data that you require for those modules")," and supply them. This means that getting up and running with Globalize 1.x is much harder. Frankly I think it's a little painful."),(0,o.kt)("p",null,"I realise this is a little ",(0,o.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Who_Moved_My_Cheese%3F"},'"Who moved my cheese"'),". I'll get over it. I do actually see the logic of this. It is certainly good that the culture date is not frozen in aspic but will evolve as the world does. But it's undeniable that in our brave new world Globalize is no longer a doddle to pick up. Or at least right now."),(0,o.kt)("h2",{id:"take-the-modules-and-run"},"Take the modules and run"),(0,o.kt)("p",null,"So. What do we actually need? Well I've consulted the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/jquery/globalize#pick-the-modules-you-need"},"documentation")," and I think I'm clear. Our simple demo cares about dates and numbers. So I'm going to guess that means I need:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/jquery/globalize#core-module"},(0,o.kt)("inlineCode",{parentName:"a"},"globalize.js"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/jquery/globalize#date-module"},(0,o.kt)("inlineCode",{parentName:"a"},"globalize/date.js"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/jquery/globalize#number-module"},(0,o.kt)("inlineCode",{parentName:"a"},"globalize/number.js")))),(0,o.kt)("p",null,"On top of that I'm also going to need the various cldr dependencies too. That's not all. Given that I've decided which modules I will use I now need to acquire the associated cldr data. According to the docs ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/jquery/globalize#2-cldr-content"},"here")," we're going to need:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"cldr/supplemental/likelySubtags.json")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"cldr/main/<i>locale</i>/ca-gregorian.json")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"cldr/main/<i>locale</i>/timeZoneNames.json")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"cldr/supplemental/timeData.json")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"cldr/supplemental/weekData.json")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"cldr/main/locale/numbers.json")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"cldr/supplemental/numberingSystems.json"))),(0,o.kt)("p",null,"Figuring that all out felt like really hard work. But I think that now we're ready to do the actual migration."),(0,o.kt)("h3",{id:"updated-30082015-globalize--so-whatcha-want"},"Updated 30/08/2015: Globalize \xb7 So What'cha Want"),(0,o.kt)("p",null,"To make working out what you need when using Globalize I've built ",(0,o.kt)("a",{parentName:"p",href:"http://johnnyreilly.github.io/globalize-so-what-cha-want/"},"Globalize \xb7 So What'cha Want"),". You're so very welcome."),(0,o.kt)("h2",{id:"the-actual-migration"},"The Actual Migration"),(0,o.kt)("p",null,"To do this I'm going to lean heavily upon ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/jquery/globalize/blob/master/examples/plain-javascript/index.html"},"an example put together by Rafael"),". The migrated code looks like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},"<html>\n  <head>\n    <title>Globalize demo</title>\n    <link\n      href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css\"\n      rel=\"stylesheet\"\n    />\n  </head>\n  <body>\n    <div class=\"container-fluid\">\n      <h4>Globalize demo for the <em id=\"locale\"></em> culture / locale</h4>\n      <p>\n        This is a the number <strong id=\"number\"></strong> formatted by\n        Globalize: <strong id=\"numberFormatted\"></strong>\n      </p>\n      <p>\n        This is a the number <strong id=\"date\"></strong> formatted by Globalize:\n        <strong id=\"dateFormatted\"></strong>\n      </p>\n    </div>\n\n    \x3c!-- First, we load Globalize's dependencies (`cldrjs` and its supplemental module). --\x3e\n    <script src=\"bower_components/cldrjs/dist/cldr.js\"><\/script>\n    <script src=\"bower_components/cldrjs/dist/cldr/event.js\"><\/script>\n    <script src=\"bower_components/cldrjs/dist/cldr/supplemental.js\"><\/script>\n\n    \x3c!-- Next, we load Globalize and its modules. --\x3e\n    <script src=\"bower_components/globalize/dist/globalize.js\"><\/script>\n    <script src=\"bower_components/globalize/dist/globalize/number.js\"><\/script>\n\n    \x3c!-- Load after globalize/number.js --\x3e\n    <script src=\"bower_components/globalize/dist/globalize/date.js\"><\/script>\n\n    <script>\n      var locale = 'de';\n\n      Promise.all([\n        // Core\n        fetch('bower_components/cldr-data/supplemental/likelySubtags.json'),\n\n        // Date\n        fetch(\n          'bower_components/cldr-data/main/' + locale + '/ca-gregorian.json',\n        ),\n        fetch(\n          'bower_components/cldr-data/main/' + locale + '/timeZoneNames.json',\n        ),\n        fetch('bower_components/cldr-data/supplemental/timeData.json'),\n        fetch('bower_components/cldr-data/supplemental/weekData.json'),\n\n        // Number\n        fetch('bower_components/cldr-data/main/' + locale + '/numbers.json'),\n        fetch('bower_components/cldr-data/supplemental/numberingSystems.json'),\n      ])\n        .then(function (responses) {\n          return Promise.all(\n            responses.map(function (response) {\n              return response.json();\n            }),\n          );\n        })\n        .then(Globalize.load)\n        .then(function () {\n          var number = 12345.67;\n          var date = new Date(2012, 5, 15);\n\n          var globalize = Globalize(locale);\n          document.querySelector('#locale').innerText = locale;\n          document.querySelector('#number').innerText = number;\n          document.querySelector('#date').innerText = date;\n          document.querySelector('#numberFormatted').innerText =\n            globalize.formatNumber(number, {\n              minimumFractionDigits: 2,\n              useGrouping: true,\n            });\n          document.querySelector('#dateFormatted').innerText =\n            globalize.formatDate(date, {\n              date: 'medium',\n            });\n        });\n    <\/script>\n  </body>\n</html>\n")),(0,o.kt)("p",null,"By the way, I'm using ",(0,o.kt)("a",{parentName:"p",href:"http://jakearchibald.com/2015/thats-so-fetch/"},"fetch")," and ",(0,o.kt)("a",{parentName:"p",href:"http://www.html5rocks.com/en/tutorials/es6/promises/"},"promises")," to load the cldr-data. This isn't mandatory - I use it because Chrome lets me. (I'm so bleeding edge.) Some standard jQuery ajax calls would do just as well. There's an example of that approach ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/jquery/globalize/blob/master/doc/cldr/index.md#how-do-i-load-cldr-data-into-globalize"},"here"),"."),(0,o.kt)("h2",{id:"observations"},"Observations"),(0,o.kt)("p",null,"We've gone from not a lot of code to... well, more than a little. A medium amount. Almost all of that extra code relates to getting Globalize 1.x to spin up so it's ready to work. We've also gone from 2 HTTP requests to 13 which is unlucky for you. 6 of them took place via ajax after the page had loaded. It's worth noting that we're not even loading all of Globalize either. On top of that there's the old order-of-loading shenanigans to deal with. All of these can be mitigated by introducing a custom build step of your own to concatenate and minify the associated cldr / Globalize files."),(0,o.kt)("p",null,"Loading the data via ajax isn't mandatory by the way. If you wanted to you could create your own style of ",(0,o.kt)("inlineCode",{parentName:"p"},"globalize.culture.de.js")," files which would allow you load the page without recourse to post-page load HTTP requests. Something like this Gulp task I've knocked up would do the trick:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"gulp.task('make-globalize-culture-de-js', function () {\n  var locale = 'de';\n  var jsonWeNeed = [\n    require('./bower_components/cldr-data/supplemental/likelySubtags.json'),\n    require('./bower_components/cldr-data/main/' +\n      locale +\n      '/ca-gregorian.json'),\n    require('./bower_components/cldr-data/main/' +\n      locale +\n      '/timeZoneNames.json'),\n    require('./bower_components/cldr-data/supplemental/timeData.json'),\n    require('./bower_components/cldr-data/supplemental/weekData.json'),\n    require('./bower_components/cldr-data/main/' + locale + '/numbers.json'),\n    require('./bower_components/cldr-data/supplemental/numberingSystems.json'),\n  ];\n\n  var jsonStringWithLoad =\n    'Globalize.load(' +\n    jsonWeNeed\n      .map(function (json) {\n        return JSON.stringify(json);\n      })\n      .join(', ') +\n    ');';\n\n  var fs = require('fs');\n  fs.writeFile(\n    './globalize.culture.' + locale + '.js',\n    jsonStringWithLoad,\n    function (err) {\n      if (err) {\n        console.log(err);\n      } else {\n        console.log('The file was created!');\n      }\n    },\n  );\n});\n")),(0,o.kt)("p",null,"The above is standard node/io type code by the way; just take the contents of the function and run in node and you should be fine. If you do use this approach then you're very much back to the simplicity of Globalize 0.1.x's approach."),(0,o.kt)("p",null,"And here is the page in all its post migration glory:"),(0,o.kt)("p",null,(0,o.kt)("img",{loading:"lazy",src:n(69599).Z,width:"640",height:"154"})),(0,o.kt)("p",null,"It looks exactly the same except 'de-DE' has become simply 'de' (since that's how the cldr rolls)."),(0,o.kt)("p",null,"The migrated code is ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/johnnyreilly/globalize-migration"},"there for the taking"),". Make sure you remember to ",(0,o.kt)("inlineCode",{parentName:"p"},"bower install")," ","-"," and you'll need to host the demo on a simple server since it makes ajax calls."),(0,o.kt)("p",null,"Before I finish off I wanted to say \"well done!\" to all the people who have worked on Globalize. It's an important project and I do apologise for my being a little critical of it here. I should say that I think it's just the getting started that's hard. Once you get over that hurdle you'll be fine. Hopefully this post will help people do just that. Pip, pip!"))}h.isMDXComponent=!0},26740:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/Screenshot-2015-07-29-06.03.04-a4188b82d910c03087d7a763cf11b6fa.webp"},69599:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/Screenshot-2015-07-30-20.21.19-fe572a5ad387af4abc3b9457cfb6606e.webp"}}]);