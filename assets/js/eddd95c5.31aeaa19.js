"use strict";(self.webpackChunkjohnnyreilly_com=self.webpackChunkjohnnyreilly_com||[]).push([[47498],{43392:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>l});var i=n(74848),o=n(28453);const a={slug:"static-typing-for-mui-react-data-grid-columns",title:"Static Typing for MUI React Data Grid Columns",authors:"johnnyreilly",tags:["typescript"],image:"./title-image.png",hide_table_of_contents:!1,description:"The MUI React Data Grid can be used with static typing to ensure the columns you pass to the component are correct. This post will show you how to do that."},r=void 0,s={permalink:"/static-typing-for-mui-react-data-grid-columns",editUrl:"https://github.com/johnnyreilly/blog.johnnyreilly.com/edit/main/blog-website/blog/2024-10-07-static-typing-for-mui-react-data-grid-columns/index.md",source:"@site/blog/2024-10-07-static-typing-for-mui-react-data-grid-columns/index.md",title:"Static Typing for MUI React Data Grid Columns",description:"The MUI React Data Grid can be used with static typing to ensure the columns you pass to the component are correct. This post will show you how to do that.",date:"2024-10-07T00:00:00.000Z",tags:[{inline:!1,label:"TypeScript",permalink:"/tags/typescript",description:"The TypeScript programming language."}],readingTime:4.26,hasTruncateMarker:!0,authors:[{name:"John Reilly",title:"OSS Engineer - TypeScript, Azure, React, Node.js, .NET",url:"https://johnnyreilly.com/about",imageURL:"https://johnnyreilly.com/img/profile.jpg",key:"johnnyreilly",page:null}],frontMatter:{slug:"static-typing-for-mui-react-data-grid-columns",title:"Static Typing for MUI React Data Grid Columns",authors:"johnnyreilly",tags:["typescript"],image:"./title-image.png",hide_table_of_contents:!1,description:"The MUI React Data Grid can be used with static typing to ensure the columns you pass to the component are correct. This post will show you how to do that."},unlisted:!1,nextItem:{title:"typescript-eslint with JSDoc JavaScript",permalink:"/typescript-eslint-with-jsdoc-js"}},c={image:n(37026).A,authorsImageUrls:[void 0]},l=[{value:"Using TypeScript to extract type information from the rows",id:"using-typescript-to-extract-type-information-from-the-rows",level:2},{value:"Applying the type information to the columns",id:"applying-the-type-information-to-the-columns",level:2},{value:"Putting it all together",id:"putting-it-all-together",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.a,{href:"https://mui.com/x/react-data-grid/",children:"MUI X Data Grid"})," is a really handy component for rendering tabular data in React applications. But one thing that is not immediately obvious is how to use TypeScript to ensure that the columns you pass to the component are correct. This post will show you how to do that."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"title image reading &quot;Static Typing for MUI React Data Grid Columns&quot; with a TypeScript logo and MUI logos",src:n(40747).A+"",width:"800",height:"450",loading:"eager",fetchpriority:"high"})}),"\n",(0,i.jsx)(t.p,{children:"Why does it matter? Well look at this screenshot of the Data Grid with incorrect column names:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"screenshot of a grid with incorrect columns",src:n(605).A+"",width:"2600",height:"870",loading:"lazy"})}),"\n",(0,i.jsxs)(t.p,{children:["Interestingly, the ",(0,i.jsx)(t.code,{children:"User"})," column is blank. Given the code, we'd probably expect to see a users name there."]}),"\n",(0,i.jsx)(t.p,{children:"Let's take look at the code for that screenshot:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-tsx",children:"import * as React from 'react';\nimport Box from '@mui/material/Box';\nimport { DataGrid } from '@mui/x-data-grid';\n\nexport default function BasicColumnsGrid() {\n  const rows = [\n    {\n      id: 1,\n      username: '@MUI',\n      age: 20,\n    },\n  ];\n\n  const columns = [\n    { field: 'user-name', headerName: 'User' },\n    { field: 'age', headerName: 'Age' },\n  ];\n\n  return (\n    <Box sx={{ height: 250, width: '100%' }}>\n      <DataGrid columns={columns} rows={rows} />\n    </Box>\n  );\n}\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The issue is that the ",(0,i.jsx)(t.code,{children:"field"})," property in the column definition is incorrect. It should be ",(0,i.jsx)(t.code,{children:"username"})," not ",(0,i.jsx)(t.code,{children:"user-name"}),". We know that, but the TypeScript compiler doesn't. And the Data Grid doesn't appear to know that either; there's no error in the console surfacing an issue."]}),"\n",(0,i.jsx)(t.h2,{id:"using-typescript-to-extract-type-information-from-the-rows",children:"Using TypeScript to extract type information from the rows"}),"\n",(0,i.jsx)(t.p,{children:"It's possible to use TypeScript to ensure that the columns you pass to the Data Grid are valid. What we want, is TypeScript to say: \"Hey, you've passed the wrong column name to the Data Grid\" (in it's own inimitable way). We can do that."}),"\n",(0,i.jsxs)(t.p,{children:["What we want to do, is use TypeScript to analyse the ",(0,i.jsx)(t.code,{children:"rows"})," array and extract type information. We can do that like so:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-diff",children:"  const rows = [\n    {\n      id: 1,\n      username: '@MUI',\n      age: 20,\n    },\n  ];\n\n+  type ValidRow = (typeof rows)[number];\n+  type ValidField = keyof ValidRow;\n+  type ColumnWithValidField = { field: ValidField };\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"ValidRow"})," type is the type of an element in the ",(0,i.jsx)(t.code,{children:"rows"})," array:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:"type ValidRow = {\n  id: number;\n  username: string;\n  age: number;\n};\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"ValidField"})," type is derived from the ",(0,i.jsx)(t.code,{children:"ValidRow"})," type; it is the keys of the ",(0,i.jsx)(t.code,{children:"ValidRow"})," type. So, the ",(0,i.jsx)(t.code,{children:"ValidField"})," type is:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:"type ValidField = 'id' | 'username' | 'age';\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Finally, we can create a type that represents a column with a valid field in the form of the ",(0,i.jsx)(t.code,{children:"ColumnWithValidField"})," type:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:"type ColumnWithValidField = {\n  field: 'id' | 'username' | 'age';\n};\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The type above says explicitly that the ",(0,i.jsx)(t.code,{children:"field"})," property of a column must be one of the keys of the ",(0,i.jsx)(t.code,{children:"ValidRow"})," type. This is the type information we require to ensure that the columns we pass to the Data Grid are correct."]}),"\n",(0,i.jsx)(t.h2,{id:"applying-the-type-information-to-the-columns",children:"Applying the type information to the columns"}),"\n",(0,i.jsxs)(t.p,{children:["Now we have this type information, we can then use that information to type the ",(0,i.jsx)(t.code,{children:"columns"})," array. We can do that like so:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-diff",children:"  const columns = [\n    { field: 'username', headerName: 'User' },\n    { field: 'age', headerName: 'Age' },\n-  ];\n+  ] satisfies GridColDef<ValidRow>[] & ColumnWithValidField[];\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Whereas previously the ",(0,i.jsx)(t.code,{children:"columns"})," array was not explicitly typed. Now it is with the ",(0,i.jsx)(t.code,{children:"satisfies"})," operator. (For an excellent explanation of ",(0,i.jsx)(t.code,{children:"satifies"})," read ",(0,i.jsx)(t.a,{href:"https://www.totaltypescript.com/clarifying-the-satisfies-operator",children:"Matt Pocock's post"}),".)"]}),"\n",(0,i.jsxs)(t.p,{children:["We are saying that ",(0,i.jsx)(t.code,{children:"columns"})," is an array of ",(0,i.jsx)(t.code,{children:"GridColDef<ValidRow>"})," ",(0,i.jsx)(t.strong,{children:"and"})," that the ",(0,i.jsx)(t.code,{children:"field"})," property of each element in the array is definitely one of the provided fields in the ",(0,i.jsx)(t.code,{children:"rows"})," data. We need both of these conditions to be true:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Using ",(0,i.jsx)(t.code,{children:"GridColDef<ValidRow>"})," ensures that the general columns schema matches what the Data Grid component needs."]}),"\n",(0,i.jsxs)(t.li,{children:["Using ",(0,i.jsx)(t.code,{children:"ColumnWithValidField"})," ensures that the ",(0,i.jsx)(t.code,{children:"field"})," property of each column is correct; based upon the ",(0,i.jsx)(t.code,{children:"rows"})," field."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Let's validate this approach works, trying to use our buggy input with this new approach:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"screenshot of a grid with incorrect columns and TypeScript surfacing the issue",src:n(17736).A+"",width:"2600",height:"1024",loading:"lazy"})}),"\n",(0,i.jsxs)(t.p,{children:["We can now see an error from the TypeScript compiler in VS Code: ",(0,i.jsx)(t.code,{children:'Type \'"user-name"\' is not assignable to type \'"id" | "username" | "age"\'. Did you mean \'"username"\'?'})," It's even an actionable error, suggesting the correct field name!"]}),"\n",(0,i.jsx)(t.h2,{id:"putting-it-all-together",children:"Putting it all together"}),"\n",(0,i.jsx)(t.p,{children:"Here's the full code (with the error corrected):"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-tsx",children:"import * as React from 'react';\nimport Box from '@mui/material/Box';\nimport { DataGrid, GridColDef } from '@mui/x-data-grid';\n\nexport default function BasicColumnsGrid() {\n  const rows = [\n    {\n      id: 1,\n      username: '@MUI',\n      age: 20,\n    },\n  ];\n\n  type ValidRow = (typeof rows)[number];\n  type ValidField = keyof ValidRow;\n  type ColumnWithValidField = { field: ValidField };\n\n  const columns = [\n    { field: 'username', headerName: 'User' },\n    { field: 'age', headerName: 'Age' },\n  ] satisfies GridColDef<ValidRow>[] & ColumnWithValidField[];\n\n  return (\n    <Box sx={{ height: 250, width: '100%' }}>\n      <DataGrid columns={columns} rows={rows} />\n    </Box>\n  );\n}\n"})}),"\n",(0,i.jsx)(t.p,{children:"With this approach, you can be confident that the columns you pass to the Data Grid are correct. This is a great way to ensure that your code is correct and that you are using the Data Grid component as intended."})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},37026:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/title-image-b1343f3a033f2c8fa62e544fa2ae894d.png"},17736:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/screenshot-incorrect-columns-with-helpful-error-9bfd0e2a98ffbb73bbf44f329eef9dff.png"},605:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/screenshot-incorrect-columns-272e7f87c6f465e5f98c0c4453958089.png"},40747:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/title-image-b1343f3a033f2c8fa62e544fa2ae894d.png"},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>s});var i=n(96540);const o={},a=i.createContext(o);function r(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);