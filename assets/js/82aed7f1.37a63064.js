"use strict";(self.webpackChunkjohnnyreilly_com=self.webpackChunkjohnnyreilly_com||[]).push([[50137],{3905:(e,t,r)=>{r.d(t,{Zo:()=>l,kt:()=>g});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var c=n.createContext({}),u=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},l=function(e){var t=u(e.components);return n.createElement(c.Provider,{value:t},e.children)},m="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),m=u(r),h=o,g=m["".concat(c,".").concat(h)]||m[h]||p[h]||a;return r?n.createElement(g,i(i({ref:t},l),{},{components:r})):n.createElement(g,i({ref:t},l))}));function g(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=h;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[m]="string"==typeof e?e:o,i[1]=s;for(var u=2;u<a;u++)i[u]=r[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},73398:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>u,toc:()=>m});r(67294);var n=r(3905);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function i(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}const s={slug:"ms-teams-direct-message-api",title:"Teams Direct Message API with Power Automate",authors:["johnnyreilly",{name:"Chris Tacey-Green",title:"Engineer, Architect, Human",url:"https://github.com/ctaceygreen",image_url:"https://avatars.githubusercontent.com/u/11404995?v=4"}],tags:["Teams","Power Automate"],image:"./title-image.png",description:"Teams does not have a public API for sending direct messages to people rather than channels. This post describes a workaround using Power Automate and the Teams Notification API.",hide_table_of_contents:!1},c=void 0,u={permalink:"/ms-teams-direct-message-api",editUrl:"https://github.com/johnnyreilly/blog.johnnyreilly.com/edit/main/blog-website/blog/2023-05-04-ms-teams-direct-message-api/index.md",source:"@site/blog/2023-05-04-ms-teams-direct-message-api/index.md",title:"Teams Direct Message API with Power Automate",description:"Teams does not have a public API for sending direct messages to people rather than channels. This post describes a workaround using Power Automate and the Teams Notification API.",date:"2023-05-04T00:00:00.000Z",formattedDate:"May 4, 2023",tags:[{label:"Teams",permalink:"/tags/teams"},{label:"Power Automate",permalink:"/tags/power-automate"}],readingTime:9.725,hasTruncateMarker:!0,authors:[{name:"John Reilly",title:"OSS Engineer - TypeScript, Azure, React, Node.js, .NET",url:"https://johnnyreilly.com/about",imageURL:"https://johnnyreilly.com/img/profile.jpg",key:"johnnyreilly"},{name:"Chris Tacey-Green",title:"Engineer, Architect, Human",url:"https://github.com/ctaceygreen",image_url:"https://avatars.githubusercontent.com/u/11404995?v=4",imageURL:"https://avatars.githubusercontent.com/u/11404995?v=4"}],frontMatter:{slug:"ms-teams-direct-message-api",title:"Teams Direct Message API with Power Automate",authors:["johnnyreilly",{name:"Chris Tacey-Green",title:"Engineer, Architect, Human",url:"https://github.com/ctaceygreen",image_url:"https://avatars.githubusercontent.com/u/11404995?v=4",imageURL:"https://avatars.githubusercontent.com/u/11404995?v=4"}],tags:["Teams","Power Automate"],image:"./title-image.png",description:"Teams does not have a public API for sending direct messages to people rather than channels. This post describes a workaround using Power Automate and the Teams Notification API.",hide_table_of_contents:!1},prevItem:{title:"Migrating Azure Functions from JSDoc JavaScript to TypeScript",permalink:"/migrating-azure-functions-from-jsdoc-javascript-to-typescript"},nextItem:{title:"Docusaurus: Structured Data FAQs with MDX",permalink:"/docusaurus-structured-data-faqs-mdx"}},l={image:r(21838).Z,authorsImageUrls:[void 0,void 0]},m=[],p={toc:m};function h(e){var{components:t}=e,s=i(e,["components"]);return(0,n.kt)("wrapper",a(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){o(e,t,r[t])}))}return e}({},p,s),{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"I've written previously about ",(0,n.kt)("a",{parentName:"p",href:"/teams-notification-webhooks"},"sending Teams notifications using a webhook"),", and it's a technique I've used a lot. But I've always wanted to be able to send a direct message to a user, and that's not possible with the webhook approach. I work with a marvellous fellow named Chris Tacey-Green, and he's figured out a way to do this using Power Automate and the Teams Notification API. I'm going to describe how he did it here, with a little help from him."),(0,n.kt)("p",null,"It's probably worth saying, both Chris and I work for Investec, and we're going to share some of the things we've learned about using Teams and Power Automate in the hope that it's useful to others. But we're not speaking on behalf of Investec, and we're not suggesting that this is the best way to do things. This is likely in the \"do things that do not scale\" category. Significantly though, it works!"),(0,n.kt)("p",null,"You will see some screenshots of our internal Teams environment, but we've tried to keep them to a minimum, and we're not going to share any sensitive information."),(0,n.kt)("p",null,(0,n.kt)("img",{loading:"eager",fetchpriority:"high",alt:"title image reading &quot;Teams Direct Message API with Power Automate&quot; with a Teams logo",src:r(21838).Z,width:"800",height:"450"})))}h.isMDXComponent=!0},21838:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/title-image-a6e4f918adb5839bf03ac87c472924d7.png"}}]);