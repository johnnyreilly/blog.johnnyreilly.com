"use strict";(self.webpackChunkjohnnyreilly_com=self.webpackChunkjohnnyreilly_com||[]).push([[37486],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>p});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),m=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=m(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=m(n),h=i,p=u["".concat(l,".").concat(h)]||u[h]||d[h]||o;return n?a.createElement(p,r(r({ref:t},c),{},{components:n})):a.createElement(p,r({ref:t},c))}));function p(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:i,r[1]=s;for(var m=2;m<o;m++)r[m]=n[m];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},44765:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>m,toc:()=>u});n(67294);var a=n(3905);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const s={slug:"xsdxml-schema-generator-xsdexe-taking",title:"XSD/XML Schema Generator + Xsd.exe:Taking the pain out of manual XML",authors:"johnnyreilly",tags:[],hide_table_of_contents:!1,description:"Discover how to use XSD for validating XML and generating C# classes from XSD files, including an online tool to simplify the task."},l=void 0,m={permalink:"/xsdxml-schema-generator-xsdexe-taking",editUrl:"https://github.com/johnnyreilly/blog.johnnyreilly.com/edit/main/blog-website/blog/2012-11-02-xsdxml-schema-generator-xsdexe-taking/index.md",source:"@site/blog/2012-11-02-xsdxml-schema-generator-xsdexe-taking/index.md",title:"XSD/XML Schema Generator + Xsd.exe:Taking the pain out of manual XML",description:"Discover how to use XSD for validating XML and generating C# classes from XSD files, including an online tool to simplify the task.",date:"2012-11-02T00:00:00.000Z",formattedDate:"November 2, 2012",tags:[],readingTime:7.815,hasTruncateMarker:!0,authors:[{name:"John Reilly",title:"OSS Engineer - TypeScript, Azure, React, Node.js, .NET",url:"https://johnnyreilly.com/about",imageURL:"https://johnnyreilly.com/img/profile.jpg",key:"johnnyreilly"}],frontMatter:{slug:"xsdxml-schema-generator-xsdexe-taking",title:"XSD/XML Schema Generator + Xsd.exe:Taking the pain out of manual XML",authors:"johnnyreilly",tags:[],hide_table_of_contents:!1,description:"Discover how to use XSD for validating XML and generating C# classes from XSD files, including an online tool to simplify the task."},prevItem:{title:"Getting up to speed with Bloomberg's Open API...",permalink:"/a-nicer-net-api-for-bloombergs-open-api"},nextItem:{title:"MVC 3 meet Dictionary",permalink:"/mvc-3-meet-dictionary"}},c={authorsImageUrls:[void 0]},u=[{value:"Is it 2003 again?!?",id:"is-it-2003-again",level:2},{value:"To the XML Batman!",id:"to-the-xml-batman",level:2},{value:"We Don&#39;t Need No Validation...",id:"we-dont-need-no-validation",level:2},{value:"Tools of the Trade",id:"tools-of-the-trade",level:2},{value:"Justify Your Actions",id:"justify-your-actions",level:2},{value:"Serialization / Deserialization Helper",id:"serialization--deserialization-helper",level:2},{value:"Updated - using Xsd.exe to generate XSD from XML",id:"updated---using-xsdexe-to-generate-xsd-from-xml",level:2}],d={toc:u};function h(e){var{components:t}=e,n=r(e,["components"]);return(0,a.kt)("wrapper",o(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){i(e,t,n[t])}))}return e}({},d,n),{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"is-it-2003-again"},"Is it 2003 again?!?"),(0,a.kt)("p",null,"I've just discovered Xsd.exe. It's not new. Or shiny. And in fact it's been around since .NET 1.1. Truth be told, I've been aware of it for years but up until now I've not had need of it. But now now I've investigated it a bit I've found that it, combined with the XSD/XML Schema Generator can make for a nice tool to add to the utility belt."),(0,a.kt)("p",null,"Granted XML has long since stopped being sexy. But if you need it, as I did recently, then this is for you."),(0,a.kt)("h2",{id:"to-the-xml-batman"},"To the XML Batman!"),(0,a.kt)("p",null,"Now XML is nothing new to me (or I imagine anyone who's been developing within the last 10 years). But most of the time when I use XML I'm barely aware that it's going on - by and large it's XML doing the heavy lifting underneath my web services. But the glory of this situation is, I never have to think about it. It just works. All I have to deal with are nice strongly typed objects which makes writing robust code a doddle."),(0,a.kt)("p",null,"I recently came upon a situation where I was working with XML in the raw; that is to say strings. I was going to be supplied with strings of XML which would represent various objects. It would be my job to take the supplied XML, extract out the data I needed and proceed accordingly."),(0,a.kt)("h2",{id:"we-dont-need-no-validation"},"We Don't Need No Validation..."),(0,a.kt)("p",null,"I lied!"),(0,a.kt)("p",null,"In order to write something reliable I needed to be able to validate that the supplied XML was as I expected. So, ",(0,a.kt)("a",{parentName:"p",href:"http://en.wikipedia.org/wiki/XML_Schema_(W3C)"},"XSD")," time. If you're familiar with XML then you're probably equally familar with XSD which, to quote Wikipedia ",(0,a.kt)("em",{parentName:"p"},"\"can be used to express a set of rules to which an XML document must conform in order to be considered 'valid'\""),"."),(0,a.kt)("p",null,"Now I've written my fair share of XSDs over the years and I've generally found it a slightly tedious exercise. So I was delighted to discover an online tool to simplify the task. It's called the ",(0,a.kt)("a",{parentName:"p",href:"http://www.freeformatter.com/xsd-generator.html"},"XSD/XML Schema Generator"),". What this marvellous tool does is allow you to enter an example of your XML which it then uses to reverse engineer an XSD."),(0,a.kt)("p",null,"Here's an example. I plugged in this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="utf-8" ?>\n<contact type="personal">\n  <firstName>John</firstName>\n  <lastName>Reilly</lastName>\n  <heightInInches>76</heightInInches>\n</contact>\n')),(0,a.kt)("p",null,"And pulled out this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xsd"},'<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">\n  <xs:element name="contact">\n    <xs:complexType>\n      <xs:sequence>\n        <xs:element type="xs:string" name="firstName"/>\n        <xs:element type="xs:string" name="lastName"/>\n        <xs:element type="xs:byte" name="heightInInches"/>\n      </xs:sequence>\n      <xs:attribute type="xs:string" name="type"/>\n    </xs:complexType>\n  </xs:element>\n</xs:schema>\n')),(0,a.kt)("p",null,"Fantastic! It doesn't matter if the tool gets something slightly wrong; you can tweak the generated XSD to your hearts content. This is great because it does the hard work for you, allowing you to step back, mop your brow and then heartily approve the results. This tool is a labour saving device. Put simply, it's a dishwasher."),(0,a.kt)("h2",{id:"tools-of-the-trade"},"Tools of the Trade"),(0,a.kt)("p",null,"How to get to the actual data? I was initially planning to break out the ",(0,a.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument(v=vs.100).aspx"},(0,a.kt)("inlineCode",{parentName:"a"},"XDocument")),", plug in my XSD and use the ",(0,a.kt)("inlineCode",{parentName:"p"},"Validate")," method. Which would do the job just dandy."),(0,a.kt)("p",null,"However I resisted. As much as I like LINQ to XML I turned to use ",(0,a.kt)("a",{parentName:"p",href:"http://msdn.microsoft.com/en-us/library/x6c1kb0s(v=vs.100).aspx"},"Xsd.exe")," instead. As I've mentioned, this tool is as old as the hills. But there's gold in them thar hills, listen: ",(0,a.kt)("em",{parentName:"p"},'"The XML Schema Definition (Xsd.exe) tool generates XML schema or common language runtime classes from XDR, XML, and XSD files, or from classes in a runtime assembly."')),(0,a.kt)("p",null,"Excited? Thought not. But what this means is we can hurl our XSD at this tool and it will toss back a nicely formatted C# class for me to use. Good stuff! So how's it done? Well MSDN is roughly as informative as it ever is (which is to say, not terribly) but fortunately there's not a great deal to it. You fire up the Visual Studio Command Prompt (and I advise doing this in Administrator mode to escape permissions pain). Then you enter a command to generate your class. Here's an example using the Contact.xsd file we generated earlier:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},'xsd.exe "C:\\\\Contact.xsd" /classes /out:"C:\\\\" /namespace:"MyNameSpace"')),(0,a.kt)("p",null,"And you're left with the lovely Contact.cs class:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},'//------------------------------------------------------------------------------\n// <auto-generated>\n//     This code was generated by a tool.\n//     Runtime Version:4.0.30319.239\n//\n//     Changes to this file may cause incorrect behavior and will be lost if\n//     the code is regenerated.\n// </auto-generated>\n//------------------------------------------------------------------------------\n\n//\n// This source code was auto-generated by xsd, Version=4.0.30319.1.\n//\nnamespace MyNameSpace {\n    using System.Xml.Serialization;\n\n\n    /// <remarks/>\n    [System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "4.0.30319.1")]\n    [System.SerializableAttribute()]\n    [System.Diagnostics.DebuggerStepThroughAttribute()]\n    [System.ComponentModel.DesignerCategoryAttribute("code")]\n    [System.Xml.Serialization.XmlTypeAttribute(AnonymousType=true)]\n    [System.Xml.Serialization.XmlRootAttribute(Namespace="", IsNullable=false)]\n    public partial class contact {\n\n        private string firstNameField;\n\n        private string lastNameField;\n\n        private sbyte heightInInchesField;\n\n        private string typeField;\n\n        /// <remarks/>\n        public string firstName {\n            get {\n                return this.firstNameField;\n            }\n            set {\n                this.firstNameField = value;\n            }\n        }\n\n        /// <remarks/>\n        public string lastName {\n            get {\n                return this.lastNameField;\n            }\n            set {\n                this.lastNameField = value;\n            }\n        }\n\n        /// <remarks/>\n        public sbyte heightInInches {\n            get {\n                return this.heightInInchesField;\n            }\n            set {\n                this.heightInInchesField = value;\n            }\n        }\n\n        /// <remarks/>\n        [System.Xml.Serialization.XmlAttributeAttribute()]\n        public string type {\n            get {\n                return this.typeField;\n            }\n            set {\n                this.typeField = value;\n            }\n        }\n    }\n}\n')),(0,a.kt)("h2",{id:"justify-your-actions"},"Justify Your Actions"),(0,a.kt)("p",null,"But why is this good stuff? Indeed why is this more interesting than the newer, and hence obviously cooler, LINQ to XML? Well for my money it's the following reasons that are important:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Intellisense - I have always loved this. Call me lazy but I think intellisense frees up the mind to think about what problem you're actually trying to solve. Xsd.exe's generated classes give me that; I don't need to hold the whole data structure in my head as I code."),(0,a.kt)("li",{parentName:"ol"},"Terse code - I'm passionate about less code. I think that a noble aim in software development is to write as little code as possible in order to achieve your aims. I say this as generally I have found that writing a minimal amount of code expresses the intention of the code in a far clearer fashion. In service of that aim Xsd.exe's generated classes allow me to write less code than would be required with LINQ to XML."),(0,a.kt)("li",{parentName:"ol"},'To quote Scott Hanselman "',(0,a.kt)("a",{parentName:"li",href:"http://www.hanselman.com/blog/NuGetPackageOfTheWeek6DynamicMalleableEnjoyableExpandoObjectsWithClay.aspx"},"successful compilation is just the first unit test"),"\". That it is but it's a doozy. If I'm making changes to the code and I've been using LINQ to XML I'm not going to see the benefits of strong typing that I would with Xsd.exe's generated classes. I like learning if I've broken the build sooner rather than later; strong typing gives me that safety net.")),(0,a.kt)("h2",{id:"serialization--deserialization-helper"},"Serialization / Deserialization Helper"),(0,a.kt)("p",null,"As you read this you're no doubt thinking \"but wait he's shown us how to create XSDs from XML and classes from XSDs but how do we take XML and turn it into objects? And how do we turn those objects back into XML?\""),(0,a.kt)("p",null,"See how I read your mind just there? It's a gift. Well, I've written a little static helper class for the very purpose:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},'using System.IO;\nusing System.Linq;\nusing System.Text;\nusing System.Xml.Serialization;\n\nnamespace My.Helpers\n{\n    public static class XmlConverter<T>\n    {\n        private static XmlSerializer _serializer = null;\n\n        #region Static Constructor\n\n        /// <summary>\n        /// Static constructor that initialises the serializer for this type\n        /// </summary>\n        static XmlConverter()\n        {\n            _serializer = new XmlSerializer(typeof(T));\n        }\n\n        #endregion\n\n        #region Public\n\n        /// <summary>\n        /// Deserialize the supplied XML into an object\n        /// </summary>\n        /// <param name="xml"></param>\n        /// <returns></returns>\n        public static T ToObject(string xml)\n        {\n            return (T)_serializer.Deserialize(new StringReader(xml));\n        }\n\n        /// <summary>\n        /// Serialize the supplied object into XML\n        /// </summary>\n        /// <param name="obj"></param>\n        /// <returns></returns>\n        public static string ToXML(T obj)\n        {\n            using (var memoryStream = new MemoryStream())\n            {\n                _serializer.Serialize(memoryStream, obj);\n\n                return Encoding.UTF8.GetString(memoryStream.ToArray());\n            }\n        }\n\n        #endregion\n    }\n}\n')),(0,a.kt)("p",null,"And here's an example of how to use it:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-cs"},"using MyNameSpace;\n\n//Make a new contact\ncontact myContact = new contact();\n\n//Serialize the contact to XML\nstring myContactXML = XmlConverter<contact>.ToXML(myContact);\n\n//Deserialize the XML back into an object\ncontact myContactAgain = XmlConverter<contact>.ToObject(myContactXML);\n")),(0,a.kt)("p",null,"I was tempted to name my methods in tribute to Crockford's JSON (namely ",(0,a.kt)("inlineCode",{parentName:"p"},"ToXML")," becoming ",(0,a.kt)("inlineCode",{parentName:"p"},"stringify")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"ToObject")," becoming ",(0,a.kt)("inlineCode",{parentName:"p"},"parse"),"). Maybe later."),(0,a.kt)("p",null,"And that's us done. Whilst it's no doubt unfashionable I think that this is a very useful approach indeed and I commend it to the interweb!"),(0,a.kt)("h2",{id:"updated---using-xsdexe-to-generate-xsd-from-xml"},"Updated - using Xsd.exe to generate XSD from XML"),(0,a.kt)("p",null,"I was chatting to a friend about this blog post and he mentioned that you can actually use Xsd.exe to generate XSD files from XML as well. He's quite right - this feature does exist. To go back to our example from earlier we can execute the following command:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},'xsd.exe "C:\\\\Contact.xml" /out:"C:\\\\"')),(0,a.kt)("p",null,"And this will generate the following file:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xsd"},'<?xml version="1.0" encoding="utf-8"?>\n<xs:schema id="NewDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">\n  <xs:element name="contact">\n    <xs:complexType>\n      <xs:sequence>\n        <xs:element name="firstName" type="xs:string" minOccurs="0" msdata:Ordinal="0" />\n        <xs:element name="lastName" type="xs:string" minOccurs="0" msdata:Ordinal="1" />\n        <xs:element name="heightInInches" type="xs:string" minOccurs="0" msdata:Ordinal="2" />\n      </xs:sequence>\n      <xs:attribute name="type" type="xs:string" />\n    </xs:complexType>\n  </xs:element>\n  <xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:UseCurrentLocale="true">\n    <xs:complexType>\n      <xs:choice minOccurs="0" maxOccurs="unbounded">\n        <xs:element ref="contact" />\n      </xs:choice>\n    </xs:complexType>\n  </xs:element>\n</xs:schema>\n')),(0,a.kt)("p",null,"However, the XSD generated above is very much a \"Microsoft XSD\"; it's an XSD which features MS properties and so on. It's fine but I think that generally I prefer my XSDs to be as vanilla as possible. To that end I'm likely to stick to using the XSD/XML Schema Generator as it doesn't appear to be possible to get Xsd.exe to generate \"vanilla XSD\"."),(0,a.kt)("p",null,"Thanks to Ajay for bringing it to my attention though."))}h.isMDXComponent=!0}}]);