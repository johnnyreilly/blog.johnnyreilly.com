<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">ts-loader goes webpack 5 | johnnyreilly</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://johnnyreilly.com/ts-loader-goes-webpack-5"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/LwQQhXdpwxeJ"><meta data-rh="true" property="og:title" content="ts-loader goes webpack 5 | johnnyreilly"><meta data-rh="true" name="description" content="TypeScript webpack loader `ts-loader` has released version 9.0.0, with support for webpack 5 and a minimum supported Node version of 12."><meta data-rh="true" property="og:description" content="TypeScript webpack loader `ts-loader` has released version 9.0.0, with support for webpack 5 and a minimum supported Node version of 12."><meta data-rh="true" property="og:image" content="https://res.cloudinary.com/priou/image/fetch/f_auto,q_auto,w_auto,dpr_auto/https://johnnyreilly.com/assets/images/ts-loader-9-414595577372387f39261670825dc882.png"><meta data-rh="true" name="twitter:image" content="https://res.cloudinary.com/priou/image/fetch/f_auto,q_auto,w_auto,dpr_auto/https://johnnyreilly.com/assets/images/ts-loader-9-414595577372387f39261670825dc882.png"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2021-04-20T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://johnnyreilly.com/about"><meta data-rh="true" property="article:tag" content="webpack,ts-loader,typescript"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://johnnyreilly.com/ts-loader-goes-webpack-5"><link data-rh="true" rel="alternate" href="https://johnnyreilly.com/ts-loader-goes-webpack-5" hreflang="en"><link data-rh="true" rel="alternate" href="https://johnnyreilly.com/ts-loader-goes-webpack-5" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://J3MYR1INLT-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="I CAN MAKE THIS WORK RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="I CAN MAKE THIS WORK Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="johnnyreilly" href="/opensearch.xml">

<link rel="icon" href="/img/profile-64x64.jpg">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#3578e5">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="preload" href="https://johnnyreilly.com/fonts/Poppins-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://johnnyreilly.com/fonts/Poppins-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preconnect" href="https://res.cloudinary.com">
<link rel="monetization" href="https://ilp.uphold.com/LwQQhXdpwxeJ">
<script type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@id":"https://johnnyreilly.com","@type":"WebSite","url":"https://johnnyreilly.com","name":"johnnyreilly","description":"This is John Reilly's blog. John is an Open Source Software Engineer working on TypeScript, Azure, React, Node.js, .NET and more.","copyrightHolder":{"@id":"https://johnnyreilly.com/about"},"publisher":{"@id":"https://johnnyreilly.com/about"},"potentialAction":{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://johnnyreilly.com/search?q={search_term_string}"},"query-input":"required name=search_term_string"},"inLanguage":"en-UK"},{"@id":"https://johnnyreilly.com/about","@type":"Person","name":"John Reilly","alternateName":"Johnny Reilly","image":{"@type":"ImageObject","inLanguage":"en-UK","@id":"https://johnnyreilly.com/about#image","url":"https://johnnyreilly.com/img/profile.jpg","contentUrl":"https://johnnyreilly.com/img/profile.jpg","width":200,"height":200,"caption":"John Reilly"},"description":"John is an Open Source Software Engineer working on TypeScript, Azure, React, Node.js, .NET and more. As well as writing code, John is a speaker at meetups, one of the founders of the TS Congress conference, and the author of the history of Definitely Typed, which he worked on in the early days of TypeScript.","url":"https://johnnyreilly.com","address":{"@type":"PostalAddress","streetAddress":"Twickenham","addressLocality":"London","addressCountry":"United Kingdom"},"email":"johnny_reilly@hotmail.com","birthPlace":"Bristol","sameAs":["https://github.com/johnnyreilly","https://fosstodon.org/@johnny_reilly","https://twitter.com/johnny_reilly","https://dev.to/johnnyreilly","https://app.daily.dev/johnnyreilly","https://stackoverflow.com/users/761388/john-reilly","https://blog.logrocket.com/author/johnreilly/","https://polywork.com/johnnyreilly","https://uk.linkedin.com/in/johnnyreilly"]},{"@id":"https://johnnyreilly.com/about#organization","@type":["Organization","Brand"],"url":"https://johnnyreilly.com","name":"johnnyreilly","description":"This is John Reilly's blog. John is an Open Source Software Engineer working on TypeScript, Azure, React, Node.js, .NET and more.","logo":{"@type":"ImageObject","inLanguage":"en-UK","@id":"https://johnnyreilly.com/#logo","url":"https://johnnyreilly.com/img/profile.jpg","contentUrl":"https://johnnyreilly.com/img/profile.jpg","width":200,"height":200,"caption":"John Reilly"},"image":{"@id":"https://johnnyreilly.com/#logo"},"sameAs":["https://github.com/johnnyreilly","https://fosstodon.org/@johnny_reilly","https://twitter.com/johnny_reilly","https://dev.to/johnnyreilly","https://app.daily.dev/johnnyreilly","https://stackoverflow.com/users/761388/john-reilly","https://blog.logrocket.com/author/johnreilly/","https://polywork.com/johnnyreilly","https://uk.linkedin.com/in/johnnyreilly"]}]}</script><link rel="stylesheet" href="/assets/css/styles.2ff0c239.css">
<script src="/assets/js/runtime~main.5b972acc.js" defer="defer"></script>
<script src="/assets/js/main.36385111.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><script type="application/ld+json">[{"@context":"https://schema.org","@type":"BreadcrumbList","@id":"/ts-loader-goes-webpack-5#breadcrumb","name":"Blog breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://johnnyreilly.com"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://johnnyreilly.com/blog"},{"@type":"ListItem","position":3,"name":"ts-loader goes webpack 5"}]}]</script><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/profile-64x64.jpg" alt="Profile picture of John Reilly" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="32"><img src="/img/profile-64x64.jpg" alt="Profile picture of John Reilly" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="32"></div><b class="navbar__title text--truncate">John Reilly</b></a><a class="navbar__item navbar__link" href="/about">About</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/talks">Talks</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/johnnyreilly" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://twitter.com/johnny_reilly" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://fosstodon.org/@johnny_reilly" target="_blank" rel="me" class="navbar__item navbar__link">Mastodon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/bun-overview">Overview of Bun, a JavaScript runtime</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/how-we-fixed-my-seo">How we fixed my SEO</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/graph-api-ad-users-group-name-ids-csharp-sdk">Graph API: getting users Active Directory group names and ids with the C# SDK</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/migrating-azure-functions-node-js-v4-typescript">Migrating to v4 Azure Functions Node.js with TypeScript</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/bicep-link-azure-application-insights-to-static-web-apps">Bicep: Link Azure Application Insights to Static Web Apps</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docusaurus-3-how-to-migrate-rehype-plugins">Docusaurus 3: how to migrate rehype plugins</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/azure-open-ai-generate-article-metadata-with-typescript">Azure Open AI: generate article metadata with TypeScript</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/typescript-documentary">TypeScript: The Movie</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="TypeScript webpack loader `ts-loader` has released version 9.0.0, with support for webpack 5 and a minimum supported Node version of 12."><link itemprop="image" href="https://johnnyreilly.com/assets/images/ts-loader-9-414595577372387f39261670825dc882.png"><header><h1 class="title_f1Hy" itemprop="headline">ts-loader goes webpack 5</h1><div class="container_mt6G margin-vert--md"><time datetime="2021-04-20T00:00:00.000Z" itemprop="datePublished">April 20, 2021</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://johnnyreilly.com/about" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://johnnyreilly.com/img/profile.jpg" alt="John Reilly" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://johnnyreilly.com/about" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">John Reilly</span></a></div><small class="avatar__subtitle" itemprop="description">OSS Engineer - TypeScript, Azure, React, Node.js, .NET</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p><code>ts-loader</code> has just released <a href="https://github.com/TypeStrong/ts-loader/releases/tag/v9.0.0" target="_blank" rel="noopener noreferrer">v9.0.0</a>. This post goes through what this release is all about, and what it took to ship this version. For intrigue, it includes a brief scamper into my mental health along the way. Some upgrades go smoothly - this one had some hiccups. But we&#x27;ll get into that.</p>
<p><img loading="eager" alt="hello world bicep" src="/assets/images/ts-loader-9-414595577372387f39261670825dc882.png" width="1376" height="510" fetchpriority="high" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="one-big-pull-request">One big pull request<a href="#one-big-pull-request" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>As of v8, <code>ts-loader</code> supported webpack 4 and webpack 5. However the webpack 5 support was best efforts, and not protected by any automated tests. <code>ts-loader</code> has two test packs:</p>
<ol>
<li>A <a href="https://github.com/TypeStrong/ts-loader/tree/main/test/comparison-tests#readme" target="_blank" rel="noopener noreferrer">comparison test pack</a> that compares transpilation and webpack compilation output with known outputs.</li>
<li>An <a href="https://github.com/TypeStrong/ts-loader/tree/main/test/execution-tests#readme" target="_blank" rel="noopener noreferrer">execution test pack</a> that executes Karma test packs written in TypeScript using <code>ts-loader</code>.</li>
</ol>
<p>The test packs were tightly coupled to webpack 4 (and in the case of the comparison test pack, that&#x27;s unavoidable). The mission was to port <code>ts-loader</code> to be built against (and have an automated test pack that ran against) webpack 5.</p>
<p>This ended up being a <a href="https://github.com/TypeStrong/ts-loader/pull/1251" target="_blank" rel="noopener noreferrer">very big pull request</a>. Work on it started back in February 2021 and we&#x27;re shipping now in April of 2021. I&#x27;d initially expected it would take a couple of days at most. I had underestimated.</p>
<p>A number of people collaborated on this PR, either with code, feedback, testing or even just responding to questions. So I&#x27;d like to say thank you to:</p>
<ul>
<li><a href="https://github.com/JonWallsten" target="_blank" rel="noopener noreferrer">John Wallsten</a> - who did a lot of the work swapping <code>ts-loader</code> over to webpack 5 APIs</li>
<li><a href="https://github.com/appzuka" target="_blank" rel="noopener noreferrer">Nick Excell</a></li>
<li><a href="https://github.com/andrewbranch" target="_blank" rel="noopener noreferrer">Andrew Branch</a></li>
<li><a href="https://github.com/alexander-akait" target="_blank" rel="noopener noreferrer">Alexander Akait</a> - who provided webpack 5 expertise and ideas</li>
<li><a href="https://github.com/sokra" target="_blank" rel="noopener noreferrer">Tobias Koppers</a> - who got me out of a hole - more on that later</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-changed">What&#x27;s changed<a href="#whats-changed" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>Let&#x27;s go through what&#x27;s different in v9. There&#x27;s two breaking changes:</p>
<ul>
<li>The minimum webpack version supported is now webpack 5. This simplifies the codebase, which previously had to if/else the various API registrations based on the version of webpack being used.</li>
<li>The minimum node version supported is now node 12. <a href="https://nodejs.org/en/about/releases/" target="_blank" rel="noopener noreferrer">Node 10 reaches end of life status at the end of April 2021.</a></li>
</ul>
<p>An interesting aspect of migrating to building against webpack 5 was dropping the dependency upon <a href="https://www.npmjs.com/package/@types/webpack" target="_blank" rel="noopener noreferrer"><code>@types/webpack</code></a> in favour of the types that now ship with webpack 5 itself. This was a mostly great experience; however we discovered some missing pieces.</p>
<p>Most notably, the <code>LoaderContext</code> <a href="https://github.com/webpack/webpack/blob/03961f33912ab6735d470b870eacff678735a9ed/lib/NormalModule.js#L424" target="_blank" rel="noopener noreferrer">wasn&#x27;t strongly typed</a>. <code>LoaderContext</code> is the value of <code>this</code> in the context of a running loader function. So it is probably the most interesting and important type from the perspective of a loader author.</p>
<p>Historically we used our own definition which had been adapted from the one in <code>@types/webpack</code>. <a href="https://github.com/webpack/webpack/issues/13162" target="_blank" rel="noopener noreferrer">I&#x27;ve looked into the possibility of a type being exposed in webpack itself.</a> However, it turns out, <a href="https://github.com/webpack/webpack/pull/13164#issuecomment-821410359" target="_blank" rel="noopener noreferrer">it&#x27;s complicated - with the <code>LoaderContext</code> type being effectively created across two packages</a>. The type is initially created in <code>webpack</code> and then augmented later in <code>loader-runner</code>, prior to being supplied to loaders. You can read more on that <a href="https://github.com/webpack/webpack/pull/13164#issuecomment-821410359" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>For now we&#x27;ve opted to stick with keeping <a href="https://github.com/TypeStrong/ts-loader/pull/1251/commits/acbc71feed91fe14ec065dd9d31081af7a492f47" target="_blank" rel="noopener noreferrer">an interface in <code>ts-loader</code></a> that models what arrives in the loader when executed. We have freshened it up somewhat, to model the webpack 5 world.</p>
<p>Alongside these changes, a <a href="https://github.com/TypeStrong/ts-loader/pull/1251/files#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519" target="_blank" rel="noopener noreferrer">number of dependencies were upgraded</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-hole">The hole<a href="#the-hole" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>By the 19th of February most of the work was done. However, <a href="https://github.com/TypeStrong/ts-loader/pull/1251#issuecomment-781967959" target="_blank" rel="noopener noreferrer">we were experiencing different behaviour between Linux and Windows in our comparison test pack</a>.</p>
<p>As far as I was aware, we were doing all the appropriate work to ensure <code>ts-loader</code> and our test packs worked cross platform. But we were still experiencing problems whenever we ran the test pack on Windows. I&#x27;d done no end of tweaking but nothing worked. I couldn&#x27;t explain it. I couldn&#x27;t fix it. I was finding that tough to deal with.</p>
<p>I really want to be transparent about the warts and all aspect of open source software development. It is like all other types of software development; sometimes things go wrong and it can be tough to work out why. Right then, I was really quite unhappy. Things weren&#x27;t working code-wise and I was at a loss to say why. This is not something that I dig.</p>
<p>I also wasn&#x27;t sleeping amazingly at this point. It was winter and we&#x27;d been in lockdown in the UK for three months; as the COVID-19 pandemic ground relentlessly on. I love my family dearly. I really do. With that said, having my children around whilst I attempted to work was remarkably tough. I love those guys but, woah, was it stressful.</p>
<p>I was feeling at a low ebb. And I wasn&#x27;t sure what to do next. So, feeling tired and pretty fed up, I took a break.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="anybody-down-there">&quot;Anybody down there?&quot;<a href="#anybody-down-there" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>Time passed. In March <a href="https://github.com/alexander-akait" target="_blank" rel="noopener noreferrer">Alexander Akait</a> checked in to see how things were going and volunteered to help. He also <a href="https://github.com/TypeStrong/ts-loader/pull/1251#issuecomment-799531375" target="_blank" rel="noopener noreferrer">suggested what turned out to be the fix</a>; namely replacing usage of <code>&#x27;\&#x27;</code> with <code>&#x27;/&#x27;</code> in the assets supplied back to webpack. But crucially I implemented this wrong. Observe <a href="https://github.com/TypeStrong/ts-loader/pull/1251/commits/4bcc5c9623acfd7ffbaf028781a8353b37243804" target="_blank" rel="noopener noreferrer">this commit</a>:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">const</span><span class="token plain"> assetPath </span><span class="token operator" style="color:#66d9ef">=</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#e6db74">relative</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">compilation</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">compiler</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">outputPath</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> outputFile</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#8292a2;font-style:italic">// According to @alexander-akait we should always &#x27;/&#x27; https://github.com/TypeStrong/ts-loader/pull/1251#issuecomment-799606985</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token function" style="color:#e6db74">replace</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex escape">\/</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-flags">g</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;/&#x27;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you look closely at the <code>replace</code> you&#x27;ll see that I&#x27;m globally replacing <code>&#x27;/&#x27;</code> with <code>&#x27;/&#x27;</code> <em>rather</em> than globally replacing <code>&#x27;\&#x27;</code> with <code>&#x27;/&#x27;</code>. The wasted time this caused... I could weep.</p>
<p>I generally thrashed around for a bit after this. Going in circles, like a six year old swimming wearing one armband. Then <a href="https://github.com/TypeStrong/ts-loader/pull/1251#issuecomment-805143890" target="_blank" rel="noopener noreferrer">Tobias kindly volunteered to help</a>. This much I&#x27;ve learned from a career in software: if talented people offer their assistance, grab it with both hands!</p>
<p>I&#x27;d been trying be as &quot;learn in public&quot; as possible about the issues I was facing on the pull request. The idea being, to surface the problems in a public forum where others can read and advise. And also to attempt a textual kind of <a href="https://en.wikipedia.org/wiki/Rubber_duck_debugging" target="_blank" rel="noopener noreferrer">rubber duck debugging</a>.</p>
<p>When Tobias pitched in, I wanted to make it as easy as possible for him to help. So I wrote up <a href="https://github.com/TypeStrong/ts-loader/pull/1251#issuecomment-805181069" target="_blank" rel="noopener noreferrer">a full description of what had changed</a>. What the divergent behaviour in test packs looked like. I shared my speculation for what might be causing the issue (I was wrong by the way). Finally I provided a simple way to get up and running with the broken code. The easier I could make it for others to collaborate on this, I figured, the greater the likelihood of an answer. Tobias got to an answer quickly:</p>
<blockquote>
<p>The problem is introduced due to some normalization logic in the test case: see <a href="https://github.com/TypeStrong/ts-loader/pull/1273" target="_blank" rel="noopener noreferrer">#1273</a></p>
<p>While the PR fixes the problem, I think the paths should be normalized earlier in the pipeline to make this normalization code unnecessary. Note that asset names should have only <code>/</code> as they are filenames and not paths. Only absolute paths have <code>\</code>.</p>
</blockquote>
<p>Tobias had raised a PR which introduced a workaround to resolved things in the test pack. This made me happy. More than that, he also identified that the issue lay in <code>ts-loader</code> itself. This caused me to look again at the changes I&#x27;d made, including my <code>replace</code> addition. <a href="https://github.com/TypeStrong/ts-loader/pull/1251#issuecomment-805907212" target="_blank" rel="noopener noreferrer">With fresh eyes, I now realised this was a bug</a>, and <a href="https://github.com/TypeStrong/ts-loader/pull/1251/commits/427714e43519289bb5745ca078133d1ace8fc2c1" target="_blank" rel="noopener noreferrer">fixed</a> it.</p>
<p>I found then that I could revert Tobias&#x27; workaround and still have passing tests. Result!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="release-details">Release details<a href="#release-details" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>Now that we&#x27;ve got there; we&#x27;ve shipped. You can get the latest version of <code>ts-loader</code> on <a href="https://www.npmjs.com/package/ts-loader/v/9.0.0" target="_blank" rel="noopener noreferrer">npm</a> and you can find the release details on <a href="https://github.com/TypeStrong/ts-loader/releases/tag/v9.0.0" target="_blank" rel="noopener noreferrer">GitHub</a>.</p>
<p>Thanks everyone - I couldn&#x27;t have done it without your help. 🌻❤️</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/webpack">webpack</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/ts-loader">ts-loader</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/typescript">typescript</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/johnnyreilly/blog.johnnyreilly.com/edit/main/blog-website/blog/2021-04-20-ts-loader-goes-webpack-5/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/service-now-api-and-typescript-conditional-types"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">The Service Now API and TypeScript Conditional Types</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/hello-world-bicep"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Hello World Bicep</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#one-big-pull-request" class="table-of-contents__link toc-highlight">One big pull request</a></li><li><a href="#whats-changed" class="table-of-contents__link toc-highlight">What&#39;s changed</a></li><li><a href="#the-hole" class="table-of-contents__link toc-highlight">The hole</a></li><li><a href="#anybody-down-there" class="table-of-contents__link toc-highlight">&quot;Anybody down there?&quot;</a></li><li><a href="#release-details" class="table-of-contents__link toc-highlight">Release details</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><div class="footer__title"><a href="/tags/typescript" class="footer__link-item">TypeScript<img src="/img/ts-logo-128.svg" alt="TypeScript icon" class="footer__icon"></a></div>
<ul class="footer__items clean-list">
  <li class="footer__item"><a href="/typescript-vs-jsdoc-javascript" class="footer__link-item">TypeScript vs JSDoc JavaScript</a></li><li class="footer__item"><a href="/type-annotations-strong-types-weakly-held" class="footer__link-item">Type annotations proposal: strong types, weakly held</a></li>
</ul><div class="footer__title"><a href="/tags/azure" class="footer__link-item">Azure<img src="/img/azure-logo.svg" alt="Azure icon" class="footer__icon"></a></div>
<ul class="footer__items clean-list">
  <li class="footer__item"><a href="/azure-container-apps-easy-auth-and-dotnet-authentication" class="footer__link-item">Azure Container Apps: Easy Auth and .NET</a></li><li class="footer__item"><a href="/azure-static-web-apps-dynamic-redirects-azure-functions" class="footer__link-item">Azure Static Web Apps: dynamic redirects with Azure Functions</a></li>
</ul><div class="footer__title"><a href="/tags/asp-net" class="footer__link-item">ASP.NET<img src="/img/dotnet-logo.svg" alt="ASP.NET icon" class="footer__icon"></a></div>
<ul class="footer__items clean-list">
  <li class="footer__item"><a href="/eslint-your-csharp-in-vs-code-with-roslyn-analyzers" class="footer__link-item">ESLint your C# with Roslyn Analyzers</a></li><li class="footer__item"><a href="/aspnet-serilog-and-application-insights" class="footer__link-item">ASP.NET, Serilog and Application Insights</a></li>
</ul><div class="footer__title"><a href="/tags/react" class="footer__link-item">React<img src="/img/react-logo.svg" alt="React icon" class="footer__icon"></a></div>
<ul class="footer__items clean-list">
  <li class="footer__item"><a href="/structured-data-seo-and-react" class="footer__link-item">Structured data and React</a></li><li class="footer__item"><a href="/react-usesearchparamsstate" class="footer__link-item">React: storing state in URL with URLSearchParams</a></li>
</ul></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><div class="footer__title">Notable articles</div>
<ul class="footer__items clean-list">
  <li class="footer__item"><a href="/definitely-typed-the-movie" class="footer__link-item">The history of Definitely Typed<img src="/img/definitely-typed-logo.png" alt="The history of Definitely Typed icon" class="footer__icon"></a></li><li class="footer__item"><a href="/typescript-documentary" class="footer__link-item">TypeScript: the documentary<img src="/img/ts-logo-128.svg" alt="TypeScript: the documentary icon" class="footer__icon"></a></li><li class="footer__item"><a href="/definitive-guide-to-migrating-from-blogger-to-docusaurus" class="footer__link-item">The definitive guide to migrating from Blogger to Docusaurus<img src="/img/docusaurus-logo.svg" alt="The definitive guide to migrating from Blogger to Docusaurus icon" class="footer__icon"></a></li><li class="footer__item"><a href="/how-we-fixed-my-seo" class="footer__link-item">How we fixed my SEO</a></li>
</ul><div class="footer__title">Popular articles</div>
<ul class="footer__items clean-list">
  <li class="footer__item"><a href="/aspnet-serilog-and-application-insights" class="footer__link-item">ASP.NET, Serilog and Application Insights</a></li><li class="footer__item"><a href="/eslint-your-csharp-in-vs-code-with-roslyn-analyzers" class="footer__link-item">ESLint your C# with Roslyn Analyzers</a></li><li class="footer__item"><a href="/prettier-your-csharp-with-dotnet-format-and-lint-staged" class="footer__link-item">dotnet-format: Prettier your C# with lint-staged & husky</a></li>
</ul><div class="footer__title">Recently updated</div>
<ul class="footer__items clean-list">
  <li class="footer__item"><a href="using-webpacks-defineplugin-with-typescript" class="footer__link-item">Understanding webpack's DefinePlugin (and using with TypeScript)</a></li><li class="footer__item"><a href="bun-overview" class="footer__link-item">Overview of Bun, a JavaScript runtime</a></li><li class="footer__item"><a href="typescript-5-importsnotusedasvalues-error-eslint-consistent-type-imports" class="footer__link-item">TypeScript 5: importsNotUsedAsValues replaced by ESLint consistent-type-imports</a></li>
</ul></li></ul></div><div class="col footer__col"><div class="footer__title">Learn more / support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/johnnyreilly/blog.johnnyreilly.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog source code on GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/tags">Blog categories</a></li><li class="footer__item"><a href="https://johnnyreilly.com/rss.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item">RSS feed<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://johnnyreilly.com/atom.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item">Atom feed<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/privacy-policy">Privacy Policy</a></li><li class="footer__item"><iframe src="https://github.com/sponsors/johnnyreilly/card" title="Sponsor johnnyreilly" style="margin-top: 20px; border: 0; border-radius: 10px; background-color: white; min-height: 400px;"></iframe></li><li class="footer__item"><a href="https://www.buymeacoffee.com/qUBm0Wh" rel="noopener" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" loading="lazy" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;"></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2012 - 2023 John Reilly. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>