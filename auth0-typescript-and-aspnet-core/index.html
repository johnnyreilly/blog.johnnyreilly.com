<!doctype html><html lang=en dir=ltr class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.1"><title data-rh=true>Auth0, TypeScript and ASP.NET Core | johnnyreilly</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://johnnyreilly.com/img/profile.jpg><meta data-rh=true name=twitter:image content=https://johnnyreilly.com/img/profile.jpg><meta data-rh=true property=og:url content=https://johnnyreilly.com/auth0-typescript-and-aspnet-core><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docusaurus_tag content=default><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docsearch:docusaurus_tag content=default><meta data-rh=true name=robots content=max-image-preview:large><meta data-rh=true name=monetization content=$ilp.uphold.com/LwQQhXdpwxeJ><meta data-rh=true property=og:title content="Auth0, TypeScript and ASP.NET Core | johnnyreilly"><meta data-rh=true name=description content="Auth0 makes authentication and authorization simple. They offer Auth-As-A-Service, quick start and easy customization of settings."><meta data-rh=true property=og:description content="Auth0 makes authentication and authorization simple. They offer Auth-As-A-Service, quick start and easy customization of settings."><meta data-rh=true property=og:type content=article><meta data-rh=true property=article:published_time content=2018-01-14T00:00:00.000Z><meta data-rh=true property=article:author content=https://johnnyreilly.com/about><meta data-rh=true property=article:tag content="React,ASP.NET,Authentication and Authorization,TypeScript"><link data-rh=true rel=icon href=/favicon.ico><link data-rh=true rel=canonical href=https://johnnyreilly.com/auth0-typescript-and-aspnet-core><link data-rh=true rel=alternate href=https://johnnyreilly.com/auth0-typescript-and-aspnet-core hreflang=en><link data-rh=true rel=alternate href=https://johnnyreilly.com/auth0-typescript-and-aspnet-core hreflang=x-default><link data-rh=true rel=preconnect href=https://J3MYR1INLT-dsn.algolia.net crossorigin><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@id":"https://johnnyreilly.com/auth0-typescript-and-aspnet-core","@type":"BlogPosting","author":{"@type":"Person","description":"OSS Engineer - TypeScript, Azure, React, Node.js, .NET","image":"https://johnnyreilly.com/img/profile.jpg","name":"John Reilly","url":"https://johnnyreilly.com/about"},"datePublished":"2018-01-14T00:00:00.000Z","description":"Auth0 makes authentication and authorization simple. They offer Auth-As-A-Service, quick start and easy customization of settings.","headline":"Auth0, TypeScript and ASP.NET Core","isPartOf":{"@id":"https://johnnyreilly.com/","@type":"Blog","name":"I CAN MAKE THIS WORK"},"keywords":[],"mainEntityOfPage":"https://johnnyreilly.com/auth0-typescript-and-aspnet-core","name":"Auth0, TypeScript and ASP.NET Core","url":"https://johnnyreilly.com/auth0-typescript-and-aspnet-core"}</script><link rel=alternate type=application/rss+xml href=/rss.xml title="I CAN MAKE THIS WORK RSS Feed"><link rel=alternate type=application/atom+xml href=/atom.xml title="I CAN MAKE THIS WORK Atom Feed"><link rel=search type=application/opensearchdescription+xml title=johnnyreilly href=/opensearch.xml><link rel=icon href=/img/profile-64x64.jpg><link rel=manifest href=/manifest.json><meta name=theme-color content=#3578e5><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=#000><link rel=apple-touch-icon href=/apple-touch-icon.png><link rel=preload href=https://johnnyreilly.com/fonts/Poppins-Regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://johnnyreilly.com/fonts/Poppins-Bold.woff2 as=font type=font/woff2 crossorigin><link rel=preconnect href=https://res.cloudinary.com><link rel=monetization href=https://ilp.uphold.com/LwQQhXdpwxeJ><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@id":"https://johnnyreilly.com","@type":"WebSite","copyrightHolder":{"@id":"https://johnnyreilly.com/about"},"description":"This is John Reilly's blog. John is an Open Source Software Engineer working on TypeScript, Azure, React, Node.js, .NET and more.","inLanguage":"en-UK","name":"johnnyreilly","potentialAction":{"@type":"SearchAction","query-input":"required name=search_term_string","target":{"@type":"EntryPoint","urlTemplate":"https://johnnyreilly.com/search?q={search_term_string}"}},"publisher":{"@id":"https://johnnyreilly.com/about"},"url":"https://johnnyreilly.com"},{"@id":"https://johnnyreilly.com/about","@type":"Person","address":{"@type":"PostalAddress","addressCountry":"United Kingdom","addressLocality":"London","streetAddress":"Twickenham"},"alternateName":"Johnny Reilly","birthPlace":"Bristol","description":"John is an Open Source Software Engineer working on TypeScript, Azure, React, Node.js, .NET and more. As well as writing code, John is a speaker at meetups, one of the founders of the TS Congress conference, and the author of the history of Definitely Typed, which he worked on in the early days of TypeScript.","email":"johnny_reilly@hotmail.com","image":{"@id":"https://johnnyreilly.com/about#image","@type":"ImageObject","caption":"John Reilly","contentUrl":"https://johnnyreilly.com/img/profile.jpg","height":200,"inLanguage":"en-UK","url":"https://johnnyreilly.com/img/profile.jpg","width":200},"name":"John Reilly","sameAs":["https://github.com/johnnyreilly","https://fosstodon.org/@johnny_reilly","https://twitter.com/johnny_reilly","https://bsky.app/profile/johnnyreilly.com","https://dev.to/johnnyreilly","https://app.daily.dev/johnnyreilly","https://stackoverflow.com/users/761388/john-reilly","https://blog.logrocket.com/author/johnreilly/","https://www.reddit.com/user/johnny_reilly","https://uk.linkedin.com/in/johnnyreilly"],"url":"https://johnnyreilly.com"},{"@id":"https://johnnyreilly.com/about#organization","@type":["Organization","Brand"],"description":"This is John Reilly's blog. John is an Open Source Software Engineer working on TypeScript, Azure, React, Node.js, .NET and more.","image":{"@id":"https://johnnyreilly.com/#logo"},"logo":{"@id":"https://johnnyreilly.com/#logo","@type":"ImageObject","caption":"John Reilly","contentUrl":"https://johnnyreilly.com/img/profile.jpg","height":200,"inLanguage":"en-UK","url":"https://johnnyreilly.com/img/profile.jpg","width":200},"name":"johnnyreilly","sameAs":["https://github.com/johnnyreilly","https://fosstodon.org/@johnny_reilly","https://twitter.com/johnny_reilly","https://bsky.app/profile/johnnyreilly.com","https://dev.to/johnnyreilly","https://app.daily.dev/johnnyreilly","https://stackoverflow.com/users/761388/john-reilly","https://blog.logrocket.com/author/johnreilly/","https://www.reddit.com/user/johnny_reilly","https://uk.linkedin.com/in/johnnyreilly"],"url":"https://johnnyreilly.com"}]}</script><link rel=webmention href=https://webmention.io/johnnyreilly.com/webmention><link rel=stylesheet href=/assets/css/styles.4cefe6d0.css><script src=/assets/js/main.d01d3435.js defer></script><script src=/assets/js/runtime~main.faae68f2.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><script type=application/ld+json>[{"@context":"https://schema.org","@id":"/auth0-typescript-and-aspnet-core#breadcrumb","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://johnnyreilly.com","name":"Home","position":1},{"@type":"ListItem","item":"https://johnnyreilly.com/blog","name":"Blog","position":2},{"@type":"ListItem","name":"Auth0, TypeScript and ASP.NET Core","position":3}],"name":"Blog breadcrumb"}]</script><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/profile-64x64.jpg alt="Profile picture of John Reilly" class="themedComponent_mlkZ themedComponent--light_NVdE" height=32 width=32><img src=/img/profile-64x64.jpg alt="Profile picture of John Reilly" class="themedComponent_mlkZ themedComponent--dark_xIcU" height=32 width=32></div><b class="navbar__title text--truncate">John Reilly</b></a><a class="navbar__item navbar__link" href=/about>About</a><a class="navbar__item navbar__link" href=/blog>Blog</a><a class="navbar__item navbar__link" href=/talks>Talks</a></div><div class="navbar__items navbar__items--right"><a href=https://github.com/johnnyreilly target=_blank rel=me class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><a href=https://bsky.app/profile/johnnyreilly.com target=_blank rel=me class="navbar__item navbar__link">Bluesky<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><a href=https://fosstodon.org/@johnny_reilly target=_blank rel=me class="navbar__item navbar__link">Mastodon<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><a href=https://twitter.com/johnny_reilly target=_blank rel=me class="navbar__item navbar__link">Twitter<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live=polite aria-pressed=false><svg viewBox="0 0 24 24" width=24 height=24 class=lightToggleIcon_pyhR><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 class=darkToggleIcon_wfgR><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label=Search><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class=row><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role=group><h3 class=yearGroupHeading_rMGB>2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/smuggling-gitignore-npmrc-in-npm-packages>Smuggling .gitignore, .npmrc and friends in npm packages</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/npx-and-azure-artifacts-the-secret-cli-delivery-mechanism>npx and Azure Artifacts: the secret CLI delivery mechanism</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/azure-artifacts-publish-private-npm-package-with-azure-devops>Azure Artifacts: Publish a private npm package with Azure DevOps</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/introducing-azdo-npm-auth>Introducing azdo-npm-auth (Azure DevOps npm auth)</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/azure-devops-set-user-story-column-api>Azure DevOps API: Set User Story column with the Azure DevOps Client for Node.js</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/module-ws-does-not-provide-an-export-named-websocketserver>module ws does not provide an export named WebSocketServer</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/static-typing-for-mui-react-data-grid-columns>Static Typing for MUI React Data Grid Columns</a><li class=sidebarItem__DBe><a class=sidebarItemLink_mo7H href=/typescript-eslint-with-jsdoc-js>typescript-eslint with JSDoc JavaScript</a></ul></div></nav></aside><main class="col col--7"><article><header><h1 class=title_f1Hy>Auth0, TypeScript and ASP.NET Core</h1><div class="container_mt6G margin-vert--md"><time datetime=2018-01-14T00:00:00.000Z>January 14, 2018</time> · <!-- -->10 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href=https://johnnyreilly.com/about target=_blank rel="noopener noreferrer" class=avatar__photo-link><img class="avatar__photo authorImage_XqGP" src=https://johnnyreilly.com/img/profile.jpg alt="John Reilly"></a><div class="avatar__intro authorDetails_lV9A"><div class=avatar__name><a href=https://johnnyreilly.com/about target=_blank rel="noopener noreferrer"><span class=authorName_yefp>John Reilly</span></a></div><small class=authorTitle_nd0D title="OSS Engineer - TypeScript, Azure, React, Node.js, .NET">OSS Engineer - TypeScript, Azure, React, Node.js, .NET</small><div class=authorSocials_rSDt></div></div></div></div></div></header><div id=__blog-post-container class=markdown><p>Most applications I write have some need for authentication and perhaps authorisation too. In fact, most apps most people write fall into that bracket. Here's the thing: Auth done well is a *big* chunk of work. And the minute you start thinking about that you almost invariably lose focus on the thing you actually want to build and ship.</p>
<p>So this Christmas I decided it was time to take a look into offloading that particular problem onto someone else. I knew there were third parties who provided Auth-As-A-Service - time to give them a whirl. On the recommendation of a friend, I made Auth0 my first port of call. Lest you be expecting a full breakdown of the various players in this space, let me stop you now; I liked Auth0 so much I strayed no further. Auth0 kicks AAAS. (I'm so sorry)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=what-i-wanted-to-build>What I wanted to build<a href=#what-i-wanted-to-build class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>My criteria for "auth success" was this:</p>
<ul>
<li>I want to build a SPA, specifically a React SPA. Ideally, I shouldn't need a back end of my own at all</li>
<li>I want to use TypeScript on my client.</li>
</ul>
<p>But, for when I do implement a back end:</p>
<ul>
<li>I want that to be able to use the client side's Auth tokens to allow access to Auth routes on my server.</li>
<li>‎I want to able to identify the user, given the token, to provide targeted data</li>
<li>Oh, and I want to use .NET Core 2 for my server.</li>
</ul>
<p>And in achieving all of the I want to add minimal code to my app. Not War and Peace. My code should remain focused on doing what it does.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=boil-a-plate>Boil a Plate<a href=#boil-a-plate class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>I ended up with unqualified ticks for all my criteria, but it took some work to find out. I will say that Auth0 do travel the extra mile in terms of getting you up and running. When you create a new Client in Auth0 you're given the option to download a quick start using the technology of your choice.</p>
<p>This was a massive plus for me. I took the quickstart provided and ran with it to get me to the point of meeting my own criteria. You can use this boilerplate for your own ends. Herewith, a walkthrough:</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=the-walkthrough>The Walkthrough<a href=#the-walkthrough class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>Fork and clone the repo at this location: <a href=https://github.com/johnnyreilly/auth0-react-typescript-asp-net-core target=_blank rel="noopener noreferrer">https://github.com/johnnyreilly/auth0-react-typescript-asp-net-core</a>.</p>
<p>What have we got? 2 folders, ClientApp contains the React app, Web contains the ASP.NET Core app. Now we need to get setup with Auth0 and customise our config.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=setup-auth0>Setup Auth0<a href=#setup-auth0 class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>Here's how to get the app set up with Auth0; you're going to need to sign up for a (free) Auth0 account. Then login into Auth0 and go to the management portal.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=client>Client<a href=#client class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<ul>
<li>Create a Client with the name of your choice and use the Single Page Web Applications template.</li>
<li>From the new Client Settings page take the Domain and Client ID and update the similarly named properties in the <code>appsettings.Development.json</code> and <code>appsettings.Production.json</code> files with these settings.</li>
<li>To the Allowed Callback URLs setting add the URLs: <code>http://localhost:3000/callback,http://localhost:5000/callback</code> - the first of these faciliates running in Debug mode, the second in Production mode. If you were to deploy this you'd need to add other callback URLs in here too.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=api>API<a href=#api class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<ul>
<li>Create an API with the name of your choice (I recommend the same as the Client to avoid confusion), an identifier which can be anything you like; I like to use the URL of my app but it's your call.</li>
<li>From the new API Settings page take the Identifier and update the Audience property in the <code>appsettings.Development.json</code> and <code>appsettings.Production.json</code> files with that value.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=running-the-app>Running the App<a href=#running-the-app class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=production-build>Production build<a href=#production-build class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>Build the client app with <code>yarn build</code> in the <code>ClientApp</code> folder. (Don't forget to <code>yarn install</code> first.) Then, in the <code>Web</code> folder <code>dotnet restore</code>, <code>dotnet run</code> and open your browser to <a href=http://localhost:5000 target=_blank rel="noopener noreferrer"><code>http://localhost:5000</code></a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=debugging>Debugging<a href=#debugging class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<p>Run the client app using webpack-dev-server using <code>yarn start</code> in the <code>ClientApp</code> folder. Fire up VS Code in the root of the repo and hit F5 to debug the server. Then open your browser to <a href=http://localhost:3000 target=_blank rel="noopener noreferrer"><code>http://localhost:3000</code></a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=the-tour>The Tour<a href=#the-tour class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>When you fire up the app you're presented with "you are not logged in!" message and the option to login. Do it, it'll take you to the Auth0 "lock" screen where you can sign up / login. Once you do that you'll be asked to confirm access:</p>
<p><img decoding=async src=/assets/images/Screenshot-2018-01-13-18.40.21-9e4bddb4a95e03eb4b5a21987952430f.webp width=395 height=400 fetchpriority=high class=img_ev3q></p>
<p>All this is powered by Auth0's <a href=https://www.npmjs.com/package/auth0-js target=_blank rel="noopener noreferrer">auth0-js</a> npm package. (Excellent type definition files are available from Definitely Typed; I'm using the <a href=https://www.npmjs.com/package/@types/auth0-js target=_blank rel="noopener noreferrer">@types/auth0-js</a> package DT publishes.) Usage of which is super simple; it exposes an <code>authorize</code> method that when called triggers the Auth0 lock screen. Once you've "okayed" you'll be taken back to the app which will use the <code>parseHash</code> method to extract the access token that Auth0 has provided. Take a look at how our <code>authStore</code> makes use of auth0-js: (don't be scared; it uses mobx - but you could use anything)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=authstorets>authStore.ts<a href=#authstorets class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#9EFEFF;--prism-background-color:#2D2A55><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style=color:#9EFEFF;background-color:#2D2A55><code class=codeBlockLines_e6Vv><span class=token-line style=color:#9EFEFF><span class="token keyword" style="color:rgb(255, 157, 0)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"> Auth0UserProfile</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> WebAuth </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">'auth0-js'</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain"></span><span class="token keyword" style="color:rgb(255, 157, 0)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"> action</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> computed</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> observable</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> runInAction </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">'mobx'</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain"></span><span class="token keyword" style="color:rgb(255, 157, 0)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"> IAuth0Config </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">'../../config'</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain"></span><span class="token keyword" style="color:rgb(255, 157, 0)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"> StorageFacade </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">'../storageFacade'</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain"></span><span class="token keyword" style="color:rgb(255, 157, 0)">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(250, 208, 0)">IStorageToken</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  accessToken</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(250, 208, 0)">string</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  idToken</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(250, 208, 0)">string</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  expiresAt</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(250, 208, 0)">number</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain"></span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain"></span><span class="token keyword" style="color:rgb(255, 157, 0)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">STORAGE_TOKEN</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">'storage_token'</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain"></span><span class="token keyword" style="color:rgb(255, 157, 0)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(250, 208, 0)">AuthStore</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token decorator at operator" style="color:rgb(255, 157, 0)">@</span><span class="token decorator function" style="color:rgb(250, 208, 0)">observable</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">ref auth0</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> WebAuth</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token decorator at operator" style="color:rgb(255, 157, 0)">@</span><span class="token decorator function" style="color:rgb(250, 208, 0)">observable</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">ref userProfile</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> Auth0UserProfile</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token decorator at operator" style="color:rgb(255, 157, 0)">@</span><span class="token decorator function" style="color:rgb(250, 208, 0)">observable</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">ref token</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> IStorageToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token function" style="color:rgb(250, 208, 0)">constructor</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    config</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> IAuth0Config</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">private</span><span class="token plain"> storage</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> StorageFacade</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">auth0 </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(250, 208, 0)">WebAuth</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      domain</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> config</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">domain</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      clientID</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> config</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">clientId</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      redirectUri</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> config</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">redirectUri</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      audience</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> config</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">audience</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      responseType</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">'token id_token'</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      scope</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">'openid email profile do:admin:thing'</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// the do:admin:thing scope is custom and defined in the scopes section of our API in the Auth0 dashboard</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token function" style="color:rgb(250, 208, 0)">initialise</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">const</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">parseToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">storage</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">getItem</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token constant" style="color:rgb(250, 208, 0)">STORAGE_TOKEN</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">setSession</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">storage</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">addEventListener</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">onStorageChanged</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token function" style="color:rgb(250, 208, 0)">parseToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">tokenString</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(250, 208, 0)">string</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">const</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">JSON</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">parse</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">tokenString </span><span class="token operator" style="color:rgb(255, 157, 0)">||</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">'{}'</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">return</span><span class="token plain"> token</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token function-variable function" style="color:rgb(250, 208, 0)">onStorageChanged</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">event</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> StorageEvent</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">key </span><span class="token operator" style="color:rgb(255, 157, 0)">===</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">STORAGE_TOKEN</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">setSession</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">parseToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">newValue</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token decorator at operator" style="color:rgb(255, 157, 0)">@</span><span class="token decorator function" style="color:rgb(250, 208, 0)">computed</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">get</span><span class="token plain"> </span><span class="token function" style="color:rgb(250, 208, 0)">isAuthenticated</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// Check whether the current time is past the</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// access token's expiry time</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">token </span><span class="token operator" style="color:rgb(255, 157, 0)">&&</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(250, 208, 0)">Date</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">getTime</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">expiresAt</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token function-variable function" style="color:rgb(250, 208, 0)">login</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">auth0</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">authorize</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token function-variable function" style="color:rgb(250, 208, 0)">handleAuthentication</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">auth0</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">parseHash</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> authResult</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      </span><span class="token keyword" style="color:rgb(255, 157, 0)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">authResult </span><span class="token operator" style="color:rgb(255, 157, 0)">&&</span><span class="token plain"> authResult</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">accessToken </span><span class="token operator" style="color:rgb(255, 157, 0)">&&</span><span class="token plain"> authResult</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">idToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token keyword" style="color:rgb(255, 157, 0)">const</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">          accessToken</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> authResult</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">accessToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">          idToken</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> authResult</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">idToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">          </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// Set the time that the access token will expire at</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">          expiresAt</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> authResult</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">expiresIn </span><span class="token operator" style="color:rgb(255, 157, 0)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(255, 98, 140)">1000</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">+</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(250, 208, 0)">Date</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">getTime</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">setSession</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// tslint:disable-next-line:no-console</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token builtin" style="color:rgb(250, 208, 0)">console</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">log</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token function" style="color:rgb(250, 208, 0)">alert</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token template-string template-punctuation string" style="color:rgb(165, 255, 144)">`</span><span class="token template-string string" style="color:rgb(165, 255, 144)">Error: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(255, 255, 255)">${</span><span class="token template-string interpolation">err</span><span class="token template-string interpolation punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token template-string interpolation">error</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token template-string string" style="color:rgb(165, 255, 144)">. Check the console for further details.</span><span class="token template-string template-punctuation string" style="color:rgb(165, 255, 144)">`</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token decorator at operator" style="color:rgb(255, 157, 0)">@</span><span class="token decorator function" style="color:rgb(250, 208, 0)">action</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token function" style="color:rgb(250, 208, 0)">setSession</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">token</span><span class="token operator" style="color:rgb(255, 157, 0)">:</span><span class="token plain"> IStorageToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">token </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> token</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">storage</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">setItem</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token constant" style="color:rgb(250, 208, 0)">STORAGE_TOKEN</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(250, 208, 0)">JSON</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">stringify</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token function-variable function" style="color:rgb(250, 208, 0)">getAccessToken</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">const</span><span class="token plain"> accessToken </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">accessToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token operator" style="color:rgb(255, 157, 0)">!</span><span class="token plain">accessToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      </span><span class="token keyword" style="color:rgb(255, 157, 0)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(250, 208, 0)">Error</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token string" style="color:rgb(165, 255, 144)">'No access token found'</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">return</span><span class="token plain"> accessToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token decorator at operator" style="color:rgb(255, 157, 0)">@</span><span class="token decorator function" style="color:rgb(250, 208, 0)">action</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token function-variable function" style="color:rgb(250, 208, 0)">loadProfile</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">const</span><span class="token plain"> accessToken </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">accessToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token operator" style="color:rgb(255, 157, 0)">!</span><span class="token plain">accessToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      </span><span class="token keyword" style="color:rgb(255, 157, 0)">return</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">auth0</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">client</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">userInfo</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">accessToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> profile</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      </span><span class="token keyword" style="color:rgb(255, 157, 0)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token keyword" style="color:rgb(255, 157, 0)">throw</span><span class="token plain"> err</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      </span><span class="token keyword" style="color:rgb(255, 157, 0)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">profile</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token function" style="color:rgb(250, 208, 0)">runInAction</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">userProfile </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> profile</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token keyword" style="color:rgb(255, 157, 0)">return</span><span class="token plain"> profile</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">      </span><span class="token keyword" style="color:rgb(255, 157, 0)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">undefined</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token decorator at operator" style="color:rgb(255, 157, 0)">@</span><span class="token decorator function" style="color:rgb(250, 208, 0)">action</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token function-variable function" style="color:rgb(250, 208, 0)">logout</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// Clear access token and ID token from local storage</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">storage</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">removeItem</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token constant" style="color:rgb(250, 208, 0)">STORAGE_TOKEN</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">token </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">null</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">this</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">userProfile </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">null</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">  </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain"></span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>Once you're logged in the app offers you more in the way of navigation options. A "Profile" screen shows you the details your React app has retrieved from Auth0 about you. This is backed by the <code>client.userInfo</code> method on <code>auth0-js</code>. There's also a "Ping" screen which is where your React app talks to your ASP.NET Core server. The screenshot below illustrates the result of hitting the "Get Private Data" button:</p>
<p><img decoding=async loading=lazy src=/assets/images/Screenshot-2018-01-13-18.47.49-80755d76b228c7780aebfecaee13b7aa.webp width=400 height=341 class=img_ev3q></p>
<p>The "Get Server to Retrieve Profile Data" button is interesting as it illustrates that the server can get access to your profile data as well. There's nothing insecure here; it gets the details using the access token retrieved from Auth0 by the ClientApp and passed to the server. It's the API we set up in Auth0 that is in play here. The app uses the Domain and the access token to talk to Auth0 like so:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=usercontrollercs>UserController.cs<a href=#usercontrollercs class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#9EFEFF;--prism-background-color:#2D2A55><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style=color:#9EFEFF;background-color:#2D2A55><code class=codeBlockLines_e6Vv><span class=token-line style=color:#9EFEFF><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// Retrieve the access_token claim which we saved in the OnTokenValidated event</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token class-name keyword" style="color:rgb(255, 157, 0)">var</span><span class="token plain"> accessToken </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> User</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Claims</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">FirstOrDefault</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">c </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Type </span><span class="token operator" style="color:rgb(255, 157, 0)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">"access_token"</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// If we have an access_token, then retrieve the user's information</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token operator" style="color:rgb(255, 157, 0)">!</span><span class="token keyword" style="color:rgb(255, 157, 0)">string</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">IsNullOrEmpty</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">accessToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token class-name keyword" style="color:rgb(255, 157, 0)">var</span><span class="token plain"> domain </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> _config</span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token string" style="color:rgb(165, 255, 144)">"Auth0:Domain"</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token class-name keyword" style="color:rgb(255, 157, 0)">var</span><span class="token plain"> apiClient </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name" style="color:rgb(250, 208, 0)">AuthenticationApiClient</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">domain</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token class-name keyword" style="color:rgb(255, 157, 0)">var</span><span class="token plain"> userInfo </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">await</span><span class="token plain"> apiClient</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">GetUserInfoAsync</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">accessToken</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token keyword" style="color:rgb(255, 157, 0)">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(250, 208, 0)">Ok</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">userInfo</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>We can also access the <code>sub</code> claim, which uniquely identifies the user:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=usercontrollercs-1>UserController.cs<a href=#usercontrollercs-1 class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#9EFEFF;--prism-background-color:#2D2A55><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style=color:#9EFEFF;background-color:#2D2A55><code class=codeBlockLines_e6Vv><span class=token-line style=color:#9EFEFF><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// We're not doing anything with this, but hey! It's useful to know where the user id lives</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token class-name keyword" style="color:rgb(255, 157, 0)">var</span><span class="token plain"> userId </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> User</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Claims</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">FirstOrDefault</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">c </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Type </span><span class="token operator" style="color:rgb(255, 157, 0)">==</span><span class="token plain"> System</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Security</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Claims</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">ClaimTypes</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">NameIdentifier</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// our userId is the sub value</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The reason our ASP.NET Core app works with Auth0 and that we have access to the access token here in the first place is because of our startup code:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=startupcs>Startup.cs<a href=#startupcs class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#9EFEFF;--prism-background-color:#2D2A55><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style=color:#9EFEFF;background-color:#2D2A55><code class=codeBlockLines_e6Vv><span class=token-line style=color:#9EFEFF><span class="token keyword" style="color:rgb(255, 157, 0)">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:rgb(255, 157, 0)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(250, 208, 0)">ConfigureServices</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token class-name" style="color:rgb(250, 208, 0)">IServiceCollection</span><span class="token plain"> services</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token class-name keyword" style="color:rgb(255, 157, 0)">var</span><span class="token plain"> domain </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token interpolation-string string" style="color:rgb(165, 255, 144)">$"https://</span><span class="token interpolation-string interpolation punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token interpolation-string interpolation expression language-csharp">Configuration</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token interpolation-string interpolation expression language-csharp string" style="color:rgb(165, 255, 144)">"Auth0:Domain"</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:rgb(255, 255, 255)">]</span><span class="token interpolation-string interpolation punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token interpolation-string string" style="color:rgb(165, 255, 144)">/"</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        services</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">AddAuthentication</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">options </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">            options</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">DefaultAuthenticateScheme </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> JwtBearerDefaults</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">AuthenticationScheme</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">            options</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">DefaultChallengeScheme </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> JwtBearerDefaults</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">AuthenticationScheme</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">AddJwtBearer</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">options </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">            options</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Authority </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> domain</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">            options</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Audience </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> Configuration</span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token string" style="color:rgb(165, 255, 144)">"Auth0:Audience"</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">            options</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Events </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name" style="color:rgb(250, 208, 0)">JwtBearerEvents</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">            </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">                OnTokenValidated </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> context </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">                </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">                    </span><span class="token keyword" style="color:rgb(255, 157, 0)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">SecurityToken </span><span class="token keyword" style="color:rgb(255, 157, 0)">is</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(250, 208, 0)">JwtSecurityToken</span><span class="token plain"> token</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">                        </span><span class="token keyword" style="color:rgb(255, 157, 0)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Principal</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Identity </span><span class="token keyword" style="color:rgb(255, 157, 0)">is</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(250, 208, 0)">ClaimsIdentity</span><span class="token plain"> identity</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">                            identity</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">AddClaim</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token keyword" style="color:rgb(255, 157, 0)">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name" style="color:rgb(250, 208, 0)">Claim</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token string" style="color:rgb(165, 255, 144)">"access_token"</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> token</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">RawData</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">                    </span><span class="token keyword" style="color:rgb(255, 157, 0)">return</span><span class="token plain"> Task</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">FromResult</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token number" style="color:rgb(255, 98, 140)">0</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">                </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">            </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// ....</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=authorization>Authorization<a href=#authorization class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h2>
<p>We're pretty much done now; just one magic button to investigate: "Get Admin Data". If you presently try and access the admin data you'll get a <code>403 Forbidden</code>. It's forbidden because that endpoint relies on the <code>"do:admin:thing"</code> scope in our claims:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=usercontrollercs-2>UserController.cs<a href=#usercontrollercs-2 class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#9EFEFF;--prism-background-color:#2D2A55><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style=color:#9EFEFF;background-color:#2D2A55><code class=codeBlockLines_e6Vv><span class=token-line style=color:#9EFEFF><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token attribute class-name" style="color:rgb(250, 208, 0)">Authorize</span><span class="token attribute attribute-arguments punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token attribute attribute-arguments">Scopes</span><span class="token attribute attribute-arguments punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token attribute attribute-arguments">DoAdminThing</span><span class="token attribute attribute-arguments punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">[</span><span class="token attribute class-name" style="color:rgb(250, 208, 0)">HttpGet</span><span class="token attribute attribute-arguments punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token attribute attribute-arguments string" style="color:rgb(165, 255, 144)">"api/userDoAdminThing"</span><span class="token attribute attribute-arguments punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">]</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token keyword" style="color:rgb(255, 157, 0)">public</span><span class="token plain"> </span><span class="token return-type class-name" style="color:rgb(250, 208, 0)">IActionResult</span><span class="token plain"> </span><span class="token function" style="color:rgb(250, 208, 0)">GetUserDoAdminThing</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token keyword" style="color:rgb(255, 157, 0)">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(250, 208, 0)">Ok</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token string" style="color:rgb(165, 255, 144)">"Admin endpoint"</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=scopescs>Scopes.cs<a href=#scopescs class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#9EFEFF;--prism-background-color:#2D2A55><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style=color:#9EFEFF;background-color:#2D2A55><code class=codeBlockLines_e6Vv><span class=token-line style=color:#9EFEFF><span class="token keyword" style="color:rgb(255, 157, 0)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(250, 208, 0)">Scopes</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">         </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// the do:admin:thing scope is custom and defined in the scopes section of our API in the Auth0 dashboard</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token keyword" style="color:rgb(255, 157, 0)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">const</span><span class="token plain"> </span><span class="token class-name keyword" style="color:rgb(255, 157, 0)">string</span><span class="token plain"> DoAdminThing </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">"do:admin:thing"</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>This wired up in our ASP.NET Core app like so:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=startupcs-1>Startup.cs<a href=#startupcs-1 class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#9EFEFF;--prism-background-color:#2D2A55><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style=color:#9EFEFF;background-color:#2D2A55><code class=codeBlockLines_e6Vv><span class=token-line style=color:#9EFEFF><span class="token plain">services</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">AddAuthorization</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">options </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        options</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">AddPolicy</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">Scopes</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">DoAdminThing</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> policy </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> policy</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Requirements</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">Add</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token keyword" style="color:rgb(255, 157, 0)">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name" style="color:rgb(250, 208, 0)">HasScopeRequirement</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">Scopes</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">DoAdminThing</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> domain</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// register the scope authorization handler</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    services</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">AddSingleton</span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;</span><span class="token plain">iauthorizationhandler</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> hasscopehandler</span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token string" style="color:rgb(165, 255, 144)">""</span><span class="token operator" style="color:rgb(255, 157, 0)">></span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain"></span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;</span><span class="token operator" style="color:rgb(255, 157, 0)">/</span><span class="token plain">iauthorizationhandler</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token operator" style="color:rgb(255, 157, 0)">></span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=hasscopehandlercs>HasScopeHandler.cs<a href=#hasscopehandlercs class=hash-link aria-label="Direct link to heading" title="Direct link to heading">​</a></h3>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#9EFEFF;--prism-background-color:#2D2A55><div class=codeBlockContent_biex><pre tabindex=0 class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style=color:#9EFEFF;background-color:#2D2A55><code class=codeBlockLines_e6Vv><span class=token-line style=color:#9EFEFF><span class="token keyword" style="color:rgb(255, 157, 0)">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(250, 208, 0)">HasScopeHandler</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">:</span><span class="token plain"> </span><span class="token type-list class-name" style="color:rgb(250, 208, 0)">AuthorizationHandler</span><span class="token type-list class-name punctuation" style="color:rgb(255, 255, 255)">&lt;</span><span class="token type-list class-name" style="color:rgb(250, 208, 0)">hasscoperequirement</span><span class="token type-list class-name punctuation" style="color:rgb(255, 255, 255)">></span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token keyword" style="color:rgb(255, 157, 0)">protected</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(255, 157, 0)">override</span><span class="token plain"> </span><span class="token return-type class-name" style="color:rgb(250, 208, 0)">Task</span><span class="token plain"> </span><span class="token function" style="color:rgb(250, 208, 0)">HandleRequirementAsync</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token class-name" style="color:rgb(250, 208, 0)">AuthorizationHandlerContext</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(255, 255, 255)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(250, 208, 0)">HasScopeRequirement</span><span class="token plain"> requirement</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token punctuation" style="color:rgb(255, 255, 255)">{</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">            </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// If user does not have the scope claim, get out of here</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">            </span><span class="token keyword" style="color:rgb(255, 157, 0)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token operator" style="color:rgb(255, 157, 0)">!</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">User</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">HasClaim</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">c </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Type </span><span class="token operator" style="color:rgb(255, 157, 0)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">"scope"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&&</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Issuer </span><span class="token operator" style="color:rgb(255, 157, 0)">==</span><span class="token plain"> requirement</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Issuer</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">                </span><span class="token keyword" style="color:rgb(255, 157, 0)">return</span><span class="token plain"> Task</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">CompletedTask</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">            </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// Split the scopes string into an array</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">            </span><span class="token class-name keyword" style="color:rgb(255, 157, 0)">var</span><span class="token plain"> scopes </span><span class="token operator" style="color:rgb(255, 157, 0)">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">User</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">FindFirst</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">c </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Type </span><span class="token operator" style="color:rgb(255, 157, 0)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(165, 255, 144)">"scope"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(255, 157, 0)">&&</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Issuer </span><span class="token operator" style="color:rgb(255, 157, 0)">==</span><span class="token plain"> requirement</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Issuer</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">Split</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token char" style="color:rgb(250, 208, 0)">' '</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">            </span><span class="token comment" style="color:rgb(179, 98, 255);font-style:italic">// Succeed if the scope array contains the required scope</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">            </span><span class="token keyword" style="color:rgb(255, 157, 0)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">scopes</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">Any</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">s </span><span class="token operator" style="color:rgb(255, 157, 0)">=></span><span class="token plain"> s </span><span class="token operator" style="color:rgb(255, 157, 0)">==</span><span class="token plain"> requirement</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">Scope</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">                context</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token function" style="color:rgb(250, 208, 0)">Succeed</span><span class="token punctuation" style="color:rgb(255, 255, 255)">(</span><span class="token plain">requirement</span><span class="token punctuation" style="color:rgb(255, 255, 255)">)</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">            </span><span class="token keyword" style="color:rgb(255, 157, 0)">return</span><span class="token plain"> Task</span><span class="token punctuation" style="color:rgb(255, 255, 255)">.</span><span class="token plain">CompletedTask</span><span class="token punctuation" style="color:rgb(255, 255, 255)">;</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">        </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain">    </span><span class="token punctuation" style="color:rgb(255, 255, 255)">}</span><span class="token plain"></span><br></span><span class=token-line style=color:#9EFEFF><span class="token plain"></span><span class="token operator" style="color:rgb(255, 157, 0)">&lt;</span><span class="token operator" style="color:rgb(255, 157, 0)">/</span><span class="token plain">hasscoperequirement</span><span class="token operator" style="color:rgb(255, 157, 0)">></span><br></span></code></pre><div class=buttonGroup__atx><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>The reason we're 403ing at present is because when our <code>HasScopeHandler</code> executes, <code>requirement.Scope</code> has the value of <code>"do:admin:thing"</code> and our <code>scopes</code> do not contain that value. To add it, go to your API in the Auth0 management console and add it:</p>
<p><img decoding=async loading=lazy src=/assets/images/Screenshot-2018-01-14-08.26.54-f554dafaf6445ce38c41dbe0c3ff2bd6.webp width=400 height=260 class=img_ev3q></p>
<p>Note that you can control how this scope is acquired using "Rules" in the Auth0 management portal.</p>
<p>You won't be able to access the admin endpoint yet because you're still rocking with the old access token; pre-newly-added scope. But when you next login to Auth0 you'll see a prompt like this:</p>
<p><img decoding=async loading=lazy src=/assets/images/Screenshot-2018-01-14-08.32.59-0ffd1e9829f22749d13b62be0cc276e6.webp width=327 height=400 class=img_ev3q></p>
<p>Which demonstrates that you're being granted an extra scope. With your new shiny access token you can now access the oh-so-secret Admin endpoint.</p>
<p>I had some more questions about Auth0 as I'm still new to it myself. To see my question (and the very helpful answer!) go here: <a href=https://community.auth0.com/questions/13786/get-user-data-server-side-what-is-a-good-approach target=_blank rel="noopener noreferrer">https://community.auth0.com/questions/13786/get-user-data-server-side-what-is-a-good-approach</a></div><footer class=docusaurus-mt-lg><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class=col><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class=tag_QGVx><a title="The React library." class="tag_zVej tagRegular_sFm0" href=/tags/react>React</a><li class=tag_QGVx><a title="The web framework built by Microsoft." class="tag_zVej tagRegular_sFm0" href=/tags/asp-net>ASP.NET</a><li class=tag_QGVx><a title="Matters related to identity and permissioning" class="tag_zVej tagRegular_sFm0" href=/tags/auth>Authentication and Authorization</a><li class=tag_QGVx><a title="The TypeScript programming language." class="tag_zVej tagRegular_sFm0" href=/tags/typescript>TypeScript</a></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class=col><a href=https://github.com/johnnyreilly/blog.johnnyreilly.com/edit/main/blog-website/blog/2018-01-14-auth0-typescript-and-aspnet-core/index.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href=/webpack-4-ts-loader-fork-ts-checker><div class=pagination-nav__sublabel>Newer Post</div><div class=pagination-nav__label>webpack 4 - ts-loader / fork-ts-checker-webpack-plugin betas</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/ts-loader-2017-retrospective><div class=pagination-nav__sublabel>Older Post</div><div class=pagination-nav__label>ts-loader 2017 retrospective</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#what-i-wanted-to-build class="table-of-contents__link toc-highlight">What I wanted to build</a><li><a href=#boil-a-plate class="table-of-contents__link toc-highlight">Boil a Plate</a><li><a href=#the-walkthrough class="table-of-contents__link toc-highlight">The Walkthrough</a><li><a href=#setup-auth0 class="table-of-contents__link toc-highlight">Setup Auth0</a><ul><li><a href=#client class="table-of-contents__link toc-highlight">Client</a><li><a href=#api class="table-of-contents__link toc-highlight">API</a></ul><li><a href=#running-the-app class="table-of-contents__link toc-highlight">Running the App</a><ul><li><a href=#production-build class="table-of-contents__link toc-highlight">Production build</a><li><a href=#debugging class="table-of-contents__link toc-highlight">Debugging</a></ul><li><a href=#the-tour class="table-of-contents__link toc-highlight">The Tour</a><ul><li><a href=#authstorets class="table-of-contents__link toc-highlight">authStore.ts</a><li><a href=#usercontrollercs class="table-of-contents__link toc-highlight">UserController.cs</a><li><a href=#usercontrollercs-1 class="table-of-contents__link toc-highlight">UserController.cs</a><li><a href=#startupcs class="table-of-contents__link toc-highlight">Startup.cs</a></ul><li><a href=#authorization class="table-of-contents__link toc-highlight">Authorization</a><ul><li><a href=#usercontrollercs-2 class="table-of-contents__link toc-highlight">UserController.cs</a><li><a href=#scopescs class="table-of-contents__link toc-highlight">Scopes.cs</a><li><a href=#startupcs-1 class="table-of-contents__link toc-highlight">Startup.cs</a><li><a href=#hasscopehandlercs class="table-of-contents__link toc-highlight">HasScopeHandler.cs</a></ul></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class=footer__title></div><ul class="footer__items clean-list"><li class=footer__item><div class=footer__title><a href=/tags/typescript class=footer__link-item>TypeScript<img src=/img/ts-logo-128.svg alt="TypeScript icon" class=footer__icon></a></div>
<ul class="footer__items clean-list">
  <li class=footer__item><a href=/typescript-vs-jsdoc-javascript class=footer__link-item>TypeScript vs JSDoc JavaScript</a><li class=footer__item><a href=/type-annotations-strong-types-weakly-held class=footer__link-item>Type annotations proposal: strong types, weakly held</a></li>
</ul><div class=footer__title><a href=/tags/azure class=footer__link-item>Azure<img src=/img/azure-logo.svg alt="Azure icon" class=footer__icon></a></div>
<ul class="footer__items clean-list">
  <li class=footer__item><a href=/azure-container-apps-easy-auth-and-dotnet-authentication class=footer__link-item>Azure Container Apps: Easy Auth and .NET</a><li class=footer__item><a href=/azure-static-web-apps-dynamic-redirects-azure-functions class=footer__link-item>Azure Static Web Apps: dynamic redirects with Azure Functions</a></li>
</ul><div class=footer__title><a href=/tags/asp-net class=footer__link-item>ASP.NET<img src=/img/dotnet-logo.svg alt="ASP.NET icon" class=footer__icon></a></div>
<ul class="footer__items clean-list">
  <li class=footer__item><a href=/eslint-your-csharp-in-vs-code-with-roslyn-analyzers class=footer__link-item>ESLint your C# with Roslyn Analyzers</a><li class=footer__item><a href=/aspnet-serilog-and-application-insights class=footer__link-item>ASP.NET, Serilog and Application Insights</a></li>
</ul><div class=footer__title><a href=/tags/react class=footer__link-item>React<img src=/img/react-logo.svg alt="React icon" class=footer__icon></a></div>
<ul class="footer__items clean-list">
  <li class=footer__item><a href=/structured-data-seo-and-react class=footer__link-item>Structured data and React</a><li class=footer__item><a href=/react-usesearchparamsstate class=footer__link-item>React: storing state in URL with URLSearchParams</a></li>
</ul></ul></div><div class="col footer__col"><div class=footer__title></div><ul class="footer__items clean-list"><li class=footer__item><div class=footer__title>Notable articles</div>
<ul class="footer__items clean-list">
  <li class=footer__item><a href=/definitely-typed-the-movie class=footer__link-item>The history of Definitely Typed<img src=/img/definitely-typed-logo.png alt="The history of Definitely Typed icon" class=footer__icon></a><li class=footer__item><a href=/typescript-documentary class=footer__link-item>TypeScript: the documentary<img src=/img/ts-logo-128.svg alt="TypeScript: the documentary icon" class=footer__icon></a><li class=footer__item><a href=/definitive-guide-to-migrating-from-blogger-to-docusaurus class=footer__link-item>The definitive guide to migrating from Blogger to Docusaurus<img src=/img/docusaurus-logo.svg alt="The definitive guide to migrating from Blogger to Docusaurus icon" class=footer__icon></a><li class=footer__item><a href=/how-we-fixed-my-seo class=footer__link-item>How we fixed my SEO</a></li>
</ul><div class=footer__title>Popular articles</div>
<ul class="footer__items clean-list">
  <li class=footer__item><a href=/aspnet-serilog-and-application-insights class=footer__link-item>ASP.NET, Serilog and Application Insights</a><li class=footer__item><a href=/eslint-your-csharp-in-vs-code-with-roslyn-analyzers class=footer__link-item>ESLint your C# with Roslyn Analyzers</a><li class=footer__item><a href=/prettier-your-csharp-with-dotnet-format-and-lint-staged class=footer__link-item>dotnet-format: Prettier your C# with lint-staged & husky</a></li>
</ul><div class=footer__title>Recently updated</div>
<ul class="footer__items clean-list">
  <li class=footer__item><a href=smuggling-gitignore-npmrc-in-npm-packages class=footer__link-item>Smuggling .gitignore, .npmrc and friends in npm packages</a><li class=footer__item><a href=es6-typescript-babel-react-flux-karma class=footer__link-item>ES6 + TypeScript + Babel + React + Flux + Karma: The Secret Recipe</a><li class=footer__item><a href=azure-pipelines-meet-vitest class=footer__link-item>Azure Pipelines meet Vitest</a></li>
</ul></ul></div><div class="col footer__col"><div class=footer__title>Learn more / support me</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/johnnyreilly/blog.johnnyreilly.com target=_blank rel="noopener noreferrer" class=footer__link-item>Blog source code on GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a class=footer__link-item href=/tags>Blog categories</a><li class=footer__item><a href=https://johnnyreilly.com/rss.xml target=_blank rel="noopener noreferrer" class=footer__link-item>RSS feed<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://johnnyreilly.com/atom.xml target=_blank rel="noopener noreferrer" class=footer__link-item>Atom feed<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a class=footer__link-item href=/privacy-policy>Privacy Policy</a><li class=footer__item><iframe src=https://github.com/sponsors/johnnyreilly/card title="Sponsor johnnyreilly" style="margin-top: 20px; border: 0; border-radius: 10px; background-color: white; min-height: 400px;"></iframe><li class=footer__item><a href=https://www.buymeacoffee.com/qUBm0Wh rel=noopener target=_blank><img src=https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png loading=lazy alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;"></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2012 - 2024 John Reilly. Built with Docusaurus.</div></div></div></footer></div>